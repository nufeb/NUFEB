LAMMPS (2 Aug 2018)
# sample LAMMPS input script for diffusion of 2d LJ liquid
# mean-squared displacement via compute msd

# settings

variable	x equal 40
variable	y equal 40

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

lattice         sq2 ${rho}
lattice         sq2 0.6
Lattice spacing in x,y,z = 1.82574 1.82574 1.82574
region          simbox block 0 $x 0 $y -0.1 0.1
region          simbox block 0 40 0 $y -0.1 0.1
region          simbox block 0 40 0 40 -0.1 0.1
create_box      1 simbox
Created orthogonal box = (0 0 -0.182574) to (73.0297 73.0297 0.182574)
  4 by 2 by 1 MPI processor grid
create_atoms    1 box
Created 3200 atoms
  Time spent = 0.000712872 secs

pair_style      lj/cut ${rc}
pair_style      lj/cut 2.5
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287
velocity        all create 1 97287

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        2 all langevin 1 $t 0.1 498094
fix	        2 all langevin 1 1 0.1 498094
fix	        3 all enforce2d

# equilibration run

thermo          1000
run	        5000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.8
  ghost atom cutoff = 2.8
  binsize = 1.4, bins = 53 53 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 3.052 | 3.052 | 3.052 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            1     -1.56492            0   -0.5652325   -1.5346995 
    1000   0.97537833   -1.5723957            0   -0.5973222   0.92877783 
    2000   0.99008371   -1.5748206            0  -0.58504633    1.0809416 
    3000    1.0111412   -1.5848987            0  -0.57407352    1.0174297 
    4000    1.0055417   -1.5857581            0  -0.58053054   0.95647691 
    5000   0.97069905   -1.5851114            0  -0.61471567   0.90108287 
Loop time of 0.648098 on 8 procs for 5000 steps with 3200 atoms

Performance: 3332829.949 tau/day, 7714.884 timesteps/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.22614    | 0.24602    | 0.27481    |   2.8 | 37.96
Neigh   | 0.066875   | 0.07135    | 0.077825   |   1.2 | 11.01
Comm    | 0.098293   | 0.12744    | 0.1569     |   5.6 | 19.66
Output  | 0.0001049  | 0.00012228 | 0.00014496 |   0.0 |  0.02
Modify  | 0.13725    | 0.14919    | 0.16903    |   2.4 | 23.02
Other   |            | 0.05398    |            |       |  8.33

Nlocal:    400 ave 406 max 394 min
Histogram: 1 1 0 1 0 2 1 0 1 1
Nghost:    202.5 ave 212 max 191 min
Histogram: 1 0 0 0 3 1 0 2 0 1
Neighs:    2800.88 ave 2903 max 2690 min
Histogram: 1 1 0 0 1 2 1 0 1 1

Total # of neighbors = 22407
Ave neighs/atom = 7.00219
Neighbor list builds = 599
Dangerous builds = 0

unfix		2

# data gathering run

reset_timestep  0

compute         vacf all vacf
fix             4 all ave/time 1 1 1 c_vacf[4] #file tmp.vacf

# factor of 0.5 is for 2d

fix             5 all vector 1 c_vacf[4]
variable        vacf equal 0.5*dt*trap(f_5)

thermo_style	custom step temp c_vacf[4] v_vacf

# only need to run for 10K steps to make a good 100-frame movie

#dump	        1 all custom 1 tmp.dump id type vx vy vz

#dump		2 all image 100 image.*.jpg type type zoom 1.6 adiam 1.2

thermo          1000
run	        100000
Per MPI rank memory allocation (min/avg/max) = 3.427 | 3.427 | 3.427 Mbytes
Step Temp c_vacf[4] v_vacf 
       0   0.97069905    1.9407914            0 
    1000   0.98138076  0.029239763   0.22157396 
    2000   0.97606079 -0.0015179052   0.23974121 
    3000   0.97924866 -0.013873067   0.21877575 
    4000   0.98568451  0.026969065   0.24052934 
    5000   0.97551815  0.050232557   0.24508207 
    6000   0.98482252 -0.0018424259   0.25686293 
    7000    0.9672559  0.018499957   0.27279836 
    8000    0.9836541 -0.022683127   0.27022734 
    9000   0.99087147 0.0071767632   0.25267902 
   10000   0.99663166 -0.011971734    0.2645822 
   11000   0.97776688   0.01601675   0.27801788 
   12000   0.98246011 0.0085456779   0.29207728 
   13000   0.98788732 0.0054252587   0.29148533 
   14000   0.96872483 0.0087976064   0.29645689 
   15000   0.98955796 -0.060068996   0.28904116 
   16000   0.99855196 -0.0066979853   0.24964957 
   17000   0.98600861  0.021334454   0.23410452 
   18000   0.98696963  -0.01971883   0.23190572 
   19000    0.9881192 -0.022828159   0.20882183 
   20000   0.98527319 -0.0085783561   0.20610922 
   21000   0.99015191 -0.0061019744   0.20199693 
   22000   0.97972418  -0.04380952   0.22099864 
   23000   0.98911012 -0.0031381071   0.19304223 
   24000   0.98810498  0.023131507   0.18483784 
   25000   0.96961962 -0.020892151   0.17128259 
   26000   0.99118408   0.02918818   0.15353531 
   27000   0.98515159 -0.026417648    0.1457756 
   28000   0.98951677  0.010372147   0.13321212 
   29000    0.9832026 0.00058150905   0.13262151 
   30000   0.98449493 0.0012256712   0.13576655 
   31000   0.96585993 0.0053021384   0.10734708 
   32000   0.98758117 -0.011513109   0.11473375 
   33000   0.98875584 -0.0089140499   0.13003947 
   34000   0.98007229  0.023423116     0.145185 
   35000   0.98415295 -0.0078343607   0.16513809 
   36000   0.98101154  0.025471963    0.1296799 
   37000   0.97606878 -0.016931612   0.11515595 
   38000   0.97220293 -0.015288346   0.12046935 
   39000     0.979783  0.039556949   0.10596988 
   40000   0.98375673 0.0098704124   0.15651085 
   41000   0.97506523 -0.029457701   0.14822207 
   42000   0.97106749 -0.024867475   0.12266294 
   43000   0.97717259  0.010866403   0.14228602 
   44000   0.98541435 -0.031545234   0.13017093 
   45000   0.97678287 -0.011024372   0.11824999 
   46000   0.98169719  0.011925437    0.1390346 
   47000   0.99471466 0.0048178625   0.13076123 
   48000   0.98332437  0.045576305   0.12667585 
   49000   0.98126947 -0.044123768   0.13582991 
   50000   0.98809751  0.014296599   0.12323107 
   51000   0.95919516 -0.0091171161    0.1494511 
   52000   0.98097913  0.010081012   0.12805794 
   53000   0.97774072  0.043349117   0.14524942 
   54000   0.99096915  0.021179196    0.1355801 
   55000   0.97652739 -0.015118967   0.14955035 
   56000   0.99185306 0.0018045061   0.16706629 
   57000   0.96289342 0.0095090659   0.19215008 
   58000   0.97871716 -0.028989119   0.20370326 
   59000   0.98637393 0.0067841088   0.21820001 
   60000   0.98009845  0.011559251   0.24504916 
   61000   0.99416712 0.0099372548   0.24882366 
   62000   0.97612483  0.014677063   0.25146482 
   63000   0.97786531 -0.0047938112   0.26052305 
   64000   0.99080668  -0.01632121   0.24744267 
   65000   0.97952497 0.0070583633   0.22323997 
   66000   0.98095955  0.036296232    0.2151706 
   67000   0.98370788 -0.0040313363   0.22236193 
   68000   0.96931818    0.0231486   0.20397659 
   69000   0.98512552 -0.017450997   0.21854935 
   70000   0.98065743  0.046916694    0.2080453 
   71000   0.98971283  0.010974871   0.21628306 
   72000   0.99890324 -0.023780184   0.23385876 
   73000   0.98649924  0.012862733   0.23458964 
   74000   0.98723422 -0.0096252165   0.23873216 
   75000    1.0025633 -0.070387674    0.2275029 
   76000   0.97859959 0.0058897922   0.22954358 
   77000   0.97973006 -0.0082868083   0.25189797 
   78000    0.9903944 -0.042368536   0.26564349 
   79000   0.96847518 -0.050630573   0.25344248 
   80000   0.99171112  0.012126001   0.23257751 
   81000   0.97202573 -0.029816198   0.27354387 
   82000   0.99368438  0.030082951   0.27859495 
   83000   0.97932483 -0.0081664387   0.27409123 
   84000   0.99078651  0.056610231   0.27593659 
   85000   0.98973457  0.020424285   0.31002605 
   86000    0.9835873 -0.0016980943   0.30158255 
   87000   0.97180564 -0.0051924508   0.27401969 
   88000   0.99743353 -0.030700753   0.24105471 
   89000   0.98993437 0.0087866525   0.23913724 
   90000    0.9926071 -0.014023378   0.24202489 
   91000   0.98800458  0.033613695    0.2238248 
   92000   0.98501879   -0.0406599   0.21809043 
   93000   0.98810082  0.027637634   0.21550897 
   94000   0.97563748 0.0014112208   0.18954766 
   95000   0.97283448 0.0093796591   0.17838358 
   96000    0.9883071  0.033049994   0.18594703 
   97000   0.97717678   0.01070451   0.19203994 
   98000   0.97190208  0.015065013   0.20906937 
   99000   0.98687379 -0.036869401   0.22993959 
  100000   0.97559757  0.045464091   0.23369283 
Loop time of 8.16691 on 8 procs for 100000 steps with 3200 atoms

Performance: 5289636.190 tau/day, 12244.528 timesteps/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.5668     | 3.6612     | 3.7867     |   4.0 | 44.83
Neigh   | 1.1409     | 1.1555     | 1.1804     |   1.4 | 14.15
Comm    | 1.581      | 1.711      | 1.8239     |   7.1 | 20.95
Output  | 0.016626   | 0.016831   | 0.017569   |   0.2 |  0.21
Modify  | 1.225      | 1.2594     | 1.3008     |   2.0 | 15.42
Other   |            | 0.363      |            |       |  4.45

Nlocal:    400 ave 413 max 391 min
Histogram: 2 1 0 2 0 0 1 1 0 1
Nghost:    204.75 ave 213 max 197 min
Histogram: 1 1 0 1 0 3 0 1 0 1
Neighs:    2800.62 ave 2959 max 2661 min
Histogram: 1 1 1 2 0 0 0 1 1 1

Total # of neighbors = 22405
Ave neighs/atom = 7.00156
Neighbor list builds = 12728
Dangerous builds = 0
Total wall time: 0:00:08
