LAMMPS (13 Oct 2016)
# sample LAMMPS input script for viscosity of 2d LJ liquid
# NEMD via fix deform and fix nvt/sllod

# settings

variable	x equal 20
variable	y equal 20

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

variable	srate equal 2.7 # velocity of top edge

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

# problem setup

lattice         sq2 ${rho}
lattice         sq2 0.6
Lattice spacing in x,y,z = 1.82574 1.82574 1.82574
region          simbox prism 0 $x 0 $y -0.1 0.1 0.0 0.0 0.0
region          simbox prism 0 20 0 $y -0.1 0.1 0.0 0.0 0.0
region          simbox prism 0 20 0 20 -0.1 0.1 0.0 0.0 0.0
create_box      1 simbox
Created triclinic box = (0 0 -0.182574) to (36.5148 36.5148 0.182574) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
create_atoms    1 box
Created 800 atoms

pair_style      lj/cut ${rc}
pair_style      lj/cut 2.5
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287
velocity        all create 1 97287

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        2 all langevin 1 $t 0.1 498094
fix	        2 all langevin 1 1 0.1 498094
fix	        3 all enforce2d

# equilibration run

thermo          1000
run	        5000
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.8
  ghost atom cutoff = 2.8
  binsize = 1.4 -> bins = 27 27 1
Memory usage per processor = 2.47956 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            1     -1.56492            0     -0.56617    -1.535262 
    1000    0.9455393    -1.573329            0  -0.62897162   0.91884199 
    2000    1.0359047   -1.6229551            0  -0.58834528   0.96136682 
    3000    1.0171488   -1.5468681            0  -0.53099077    1.1078235 
    4000    1.0040221   -1.5977142            0  -0.59494717   0.92428924 
    5000   0.95883045   -1.6087309            0    -0.651099    0.9201564 
Loop time of 0.896852 on 1 procs for 5000 steps with 800 atoms

Performance: 2408424.088 tau/day, 5575.056 timesteps/s
100.0% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.47349    | 0.47349    | 0.47349    |   0.0 | 52.79
Neigh   | 0.15355    | 0.15355    | 0.15355    |   0.0 | 17.12
Comm    | 0.017267   | 0.017267   | 0.017267   |   0.0 |  1.93
Output  | 4.3392e-05 | 4.3392e-05 | 4.3392e-05 |   0.0 |  0.00
Modify  | 0.2278     | 0.2278     | 0.2278     |   0.0 | 25.40
Other   |            | 0.0247     |            |       |  2.75

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    266 ave 266 max 266 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5604 ave 5604 max 5604 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5604
Ave neighs/atom = 7.005
Neighbor list builds = 548
Dangerous builds = 0

unfix  	        1
unfix		2

# turn on NEMD shear and equilibrate some more

velocity	all scale $t
velocity	all scale 1

# shear rate defined relative to perpendicular dimension

variable	xyrate equal ${srate}/ly
variable	xyrate equal 2.7/ly

fix		1 all nvt/sllod temp $t $t 0.1
fix		1 all nvt/sllod temp 1 $t 0.1
fix		1 all nvt/sllod temp 1 1 0.1
fix		2 all deform 1 xy erate ${xyrate} remap v
fix		2 all deform 1 xy erate 0.0739425452631974 remap v

compute         layers all chunk/atom bin/1d y center 0.05 units reduced
fix		4 all ave/chunk 20 250 5000 layers vx file profile.nemd.2d

compute		usual all temp
compute		tilt all temp/deform

thermo          1000
thermo_style	custom step temp c_usual epair etotal press pxy
thermo_modify	temp tilt
run		50000
Memory usage per processor = 2.74501 Mbytes
Step Temp c_usual E_pair TotEng Press Pxy 
    5000    2.2074694            1   -1.6087309   0.59597914    1.6684033  -0.13173628 
    6000   0.93152386    1.0817401   -1.6660819  -0.73572242   0.68318536 -0.028129339 
    7000    1.0014344    1.1738041   -1.7011099  -0.70092725    0.6084685  -0.14709751 
    8000     1.025345      1.29299   -1.7011316  -0.67706829   0.58584918  -0.13492866 
    9000   0.98439625    1.3014301   -1.6432929  -0.66012715   0.78568164   0.03166088 
   10000   0.94167448     1.304837   -1.6809777  -0.74048031    0.6767415  0.004807405 
   11000   0.98264458    1.3309352   -1.6681636  -0.68674728   0.74844384 -0.043997826 
   12000   0.99403655    1.3580131   -1.6369662   -0.6441722   0.86251493  -0.05441449 
   13000    1.0396869    1.4466214   -1.6285376  -0.59015033   0.85584533 -0.077842666 
   14000    1.0356564    1.4337041   -1.6284938  -0.59413198   0.86325196  0.021727401 
   15000   0.97016374    1.4146903   -1.6551162  -0.68616512   0.78678055 -0.067107584 
   16000   0.94805836    1.4367742   -1.6338511  -0.68697777    0.8447822  -0.11723973 
   17000    0.9784648    1.4621496   -1.6203417  -0.64309998   0.93704401 -0.070556149 
   18000    1.0180917    1.5223337   -1.6393062  -0.62248714   0.81117394  -0.21773149 
   19000    1.0186815    1.5716289   -1.6471996  -0.62979147   0.71667451 -0.091605896 
   20000    0.9743659    1.5914706   -1.6150957  -0.64194775   0.94267754 -0.034378699 
   21000    1.0482265    1.5882157   -1.6319486  -0.58503242   0.86464563  -0.30608617 
   22000    1.0372488    1.6614229    -1.618808  -0.58285576    0.9619593  0.030218471 
   23000      1.02322     1.605947   -1.6128071   -0.5908661   0.89153388 -0.054926254 
   24000   0.99202826    1.6263761   -1.6309182     -0.64013   0.82035209  -0.15760707 
   25000   0.96842077    1.6079837   -1.6514188   -0.6842086   0.74289154  -0.15054022 
   26000    1.0131182    1.6599526   -1.6282941  -0.61644236   0.79717592  -0.17392393 
   27000   0.99274208    1.6992131   -1.6141775   -0.6226763   0.87559226 -0.025698533 
   28000    1.0124353     1.682322   -1.6350699  -0.62390012   0.81863458  -0.10578616 
   29000    1.0159913    1.7444965    -1.670694  -0.65597278   0.77422638 -0.074417391 
   30000   0.95757504    1.6770477   -1.6100645  -0.65368638   0.84900509  -0.13811335 
   31000    0.9882106    1.7024812   -1.6135646  -0.62658928    0.8819342 -0.0083109839 
   32000   0.94243022     1.665312   -1.6173333  -0.67608112    1.0312796 -0.087350514 
   33000   0.97629132     1.804652   -1.6148954  -0.63982441   0.73933894 -0.010842321 
   34000   0.96053868     1.768861   -1.6201954  -0.66085743   0.80440002 -0.0098573375 
   35000   0.96192532    1.7951878   -1.5904258  -0.62970292   0.98930679  0.061382767 
   36000     1.034984     1.835204   -1.5872923  -0.55360202    1.1673704 -0.086610164 
   37000    1.0109946    1.8695414   -1.5899371  -0.58020627    1.0247304 -0.081320896 
   38000    1.0189063    1.9299754    -1.591087  -0.57345437    1.0238951  -0.12903934 
   39000   0.96964269    1.8518181   -1.5939152  -0.62548456     1.064667  -0.12625393 
   40000   0.93813023    1.8601846   -1.5808497  -0.64389211    1.0739269  -0.21342957 
   41000      1.01992    1.9192923   -1.6087202  -0.59007511   0.96050424   -0.3264004 
   42000    1.0243282    1.9429183   -1.5918401  -0.56879229    1.1845661 -0.062971629 
   43000    1.0696065    2.0074757   -1.5973264  -0.52905692   0.90524954  -0.12923233 
   44000    1.0338542    1.9624549   -1.6079246  -0.57536268    1.0536815  0.070524993 
   45000   0.95583069     1.945773   -1.6279372  -0.67330128   0.74985796  -0.17325375 
   46000   0.99732695     1.966957    -1.631205   -0.6351247   0.77350616   -0.1852725 
   47000    1.0135329    2.0107676   -1.6049852  -0.59271924   0.87782961  -0.20632054 
   48000   0.98735917    1.9771245   -1.6053591  -0.61923413   0.92710662 -0.0002501296 
   49000   0.99618418    1.9493979   -1.6066882  -0.61174922   0.89595133  -0.20337142 
   50000    1.0651949    2.0467535   -1.6074294  -0.54356601   0.99645561 -0.099150393 
   51000    1.0559004    2.0710034   -1.5978367  -0.54325617   0.99030671   -0.1841017 
   52000    1.0083619    2.0399634   -1.5973313   -0.5902299    1.1130916 -0.0079150985 
   53000    1.0118925    2.0439094   -1.5896233  -0.57899564    1.1640067 -0.053482574 
   54000    1.0162238    2.0117062   -1.6173202  -0.60236666   0.92299331  -0.13080758 
   55000    1.0101742    2.0023882   -1.5870609  -0.57814937    1.0166974   -0.2462163 
Loop time of 12.3385 on 1 procs for 50000 steps with 800 atoms

Performance: 1750615.444 tau/day, 4052.351 timesteps/s
99.9% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.0133     | 5.0133     | 5.0133     |   0.0 | 40.63
Neigh   | 3.262      | 3.262      | 3.262      |   0.0 | 26.44
Comm    | 0.29422    | 0.29422    | 0.29422    |   0.0 |  2.38
Output  | 0.0017447  | 0.0017447  | 0.0017447  |   0.0 |  0.01
Modify  | 3.4226     | 3.4226     | 3.4226     |   0.0 | 27.74
Other   |            | 0.3447     |            |       |  2.79

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    282 ave 282 max 282 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5602 ave 5602 max 5602 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5602
Ave neighs/atom = 7.0025
Neighbor list builds = 11232
Dangerous builds = 0

# data gathering run

variable	visc equal -pxy/(v_srate/ly)
fix		vave all ave/time 10 100 1000 v_visc ave running start 56000

thermo_style	custom step temp press pxy v_visc f_vave
WARNING: New thermo_style command, previous thermo_modify settings will be lost (../output.cpp:690)
thermo_modify	temp tilt

# only need to run for 5400 steps to make a good 100-frame movie
# set 54K steps above in equil and 5400 here simply to make good movie
# 54K and 5400 are multiples of box-swap periodicity = 2700 steps

#dump	        1 all custom 50 dump.nemd.2d id type x y z vx

#dump		2 all image 50 image.*.jpg vx type zoom 1.2 adiam 1.2
#dump_modify	2 pad 5 amap 0.0 ${srate} ca 0.0 2 min blue max red

run		50000
Memory usage per processor = 2.75392 Mbytes
Step Temp Press Pxy v_visc f_vave 
   55000    1.0101742    1.0168023  -0.24961054    3.3757364            0 
   56000   0.95430669   0.99109494  -0.11503816    1.5557777   0.73512854 
   57000   0.96493583   0.77019161  0.032071381   -0.4337338   0.69832329 
   58000     1.043882     1.190321   -0.1948503    2.6351582    0.7662455 
   59000   0.99522262   0.71653967 -0.056810457    0.7683054   0.87054399 
   60000    1.0147329    1.0803743  -0.13097761    1.7713431    0.8832817 
   61000   0.93812211    1.0627199 -0.044643317   0.60375683   0.96513251 
   62000    1.0107288   0.93643991  -0.07289428   0.98582325   0.99515995 
   63000    1.0516762     1.206755  -0.12107833     1.637465    1.0476529 
   64000   0.96288473   0.99015782 -0.040632073   0.54950872    1.0857708 
   65000   0.96981457    1.1393466  0.081769326   -1.1058495    1.0598383 
   66000    1.0549734    0.9862292 -0.038519333   0.52093599    1.0631279 
   67000    1.0597179    1.0849355  0.026292892  -0.35558543    1.0560538 
   68000    1.0260974   0.95293785  0.049285149  -0.66653304    1.0367987 
   69000    1.0075299    1.0303201  0.041539329  -0.56177846    1.0467854 
   70000    1.0622593    1.2021547  -0.20731618    2.8037469    1.0667574 
   71000   0.99847432    1.0509829  -0.15346894     2.075516    1.0655178 
   72000   0.97453232   0.97670205  -0.22406814    3.0303006    1.0503175 
   73000    0.9641619   0.89104495  -0.12889334    1.7431553    1.0532335 
   74000   0.99089222    1.0444418   0.18074575    -2.444408    1.0546561 
   75000   0.99756998   0.91703128  -0.21829649    2.9522447     1.065423 
   76000   0.93605182   0.98651769  -0.20794378    2.8122346    1.0798472 
   77000   0.94258356   0.95471193  -0.14211735    1.9219969    1.0819944 
   78000    0.9798062    1.2187257 -0.063527885   0.85915199    1.1001509 
   79000   0.96451401   0.84225692 -0.025071518   0.33906755    1.0969807 
   80000   0.95011391    1.0570755  -0.11124947    1.5045394    1.1031908 
   81000   0.99774906   0.96668849 -0.0053084468  0.071791507    1.1312113 
   82000   0.98889022    0.8762984  0.071585243  -0.96811981    1.1334001 
   83000   0.93610495    1.0660717 -0.047681336   0.64484304    1.1299719 
   84000    1.0072593    1.0286446  -0.21827159     2.951908    1.1400137 
   85000    1.0128434    1.0894592 -0.094017511    1.2714941    1.1421825 
   86000    1.0193552   0.99088304 -0.057046347   0.77149558    1.1372979 
   87000   0.92702641   0.88034638 -0.012355342   0.16709381    1.1311508 
   88000   0.98946493   0.81515436  0.016806513  -0.22729152    1.1379472 
   89000   0.99799875    1.0151454 -0.084127501    1.1377415    1.1352016 
   90000   0.99133716   0.86655201 -0.056333485   0.76185483    1.1447978 
   91000   0.94330916   0.93345911  -0.12219086    1.6525109    1.1417404 
   92000   0.94909987    1.0726222  -0.26976121    3.6482544    1.1573797 
   93000   0.99526745    1.0680147   -0.1142234    1.5447588    1.1646702 
   94000    1.0018217    1.1512259  -0.19659509    2.6587547    1.1604884 
   95000    0.9686519    1.0577224 -0.055162686   0.74602092    1.1618973 
   96000   0.97493046   0.96044751  0.050456814  -0.68237864    1.1574483 
   97000   0.97351913    1.0981546  -0.16357534    2.2121952    1.1677946 
   98000    1.0157509   0.97339707  -0.13441353    1.8178105    1.1778369 
   99000    1.0414889    1.0103719  -0.10696881    1.4466477    1.1823616 
  100000    1.0249428    1.0036886  -0.27447626    3.7120207    1.1792453 
  101000   0.96960692   0.94692891 -0.053860891   0.72841544    1.1752286 
  102000    1.0371247    1.0840917 -0.040114754   0.54251249    1.1644228 
  103000   0.96769028    1.0471324  -0.07971043    1.0780049    1.1657168 
  104000   0.96896685    1.0326732  -0.23873693    3.2286815     1.162545 
  105000    1.0122807   0.97927614 -0.068569604   0.92733627    1.1684457 
Loop time of 12.8562 on 1 procs for 50000 steps with 800 atoms

Performance: 1680117.354 tau/day, 3889.161 timesteps/s
99.9% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.0725     | 5.0725     | 5.0725     |   0.0 | 39.46
Neigh   | 3.5621     | 3.5621     | 3.5621     |   0.0 | 27.71
Comm    | 0.31528    | 0.31528    | 0.31528    |   0.0 |  2.45
Output  | 0.00097895 | 0.00097895 | 0.00097895 |   0.0 |  0.01
Modify  | 3.5411     | 3.5411     | 3.5411     |   0.0 | 27.54
Other   |            | 0.3643     |            |       |  2.83

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    283 ave 283 max 283 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5585 ave 5585 max 5585 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5585
Ave neighs/atom = 6.98125
Neighbor list builds = 12225
Dangerous builds = 0
Total wall time: 0:00:26
