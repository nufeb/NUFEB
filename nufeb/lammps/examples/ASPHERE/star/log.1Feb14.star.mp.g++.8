LAMMPS (1 Feb 2014)
# SRD viscosity demo - rigid star particles

units		lj
atom_style	sphere
atom_modify	map array first big
dimension	2

# read in clusters of rigid bodies

fix             molprop all property/atom mol
read_data	data.star fix molprop NULL Molecules
  orthogonal box = (-13.2934 -13.2934 -0.5) to (13.2934 13.2934 0.5)
  4 by 2 by 1 MPI processor grid
  reading atoms ...
  270 atoms

set		type 1 mass 1.0
  270 settings made for mass
group		big type 1
270 atoms in group big
velocity	big create 1.44 87287 loop geom

# equilibrate big particles

pair_style	soft 1.12
pair_coeff	1 1 0.0
pair_coeff	2 2 0.0 0.0
pair_coeff	1 2 0.0 0.0

variable        prefactor equal ramp(0,60)
fix             soft all adapt 1 pair soft a * * v_prefactor

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

fix		1 big rigid molecule
30 rigid bodies with 270 atoms
fix		2 all enforce2d

#dump		1 all atom 10 dump.star.equil

thermo		100
run		1000
Memory usage per processor = 2.64859 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            0            0            0            0   0.24721146 
     100            0     3.291475            0     3.291475   0.69158089 
     200            0    4.6176595            0    4.6176595   0.71737945 
     300            0    7.0921814            0    7.0921814    1.2163497 
     400            0    8.3666709            0    8.3666709   0.50645957 
     500            0    10.630838            0    10.630838   0.72764487 
     600            0     12.42157            0     12.42157    1.0130599 
     700            0    14.349074            0    14.349074   0.74795509 
     800            0    16.464746            0    16.464746     1.054549 
     900            0    18.253108            0    18.253108   0.51551753 
    1000            0    20.699563            0    20.699563    1.8084662 
Loop time of 0.0484946 on 8 procs for 1000 steps with 270 atoms

Pair  time (%) = 0.00250834 (5.17242)
Neigh time (%) = 0.000999629 (2.06132)
Comm  time (%) = 0.0154877 (31.9369)
Outpt time (%) = 0.000273734 (0.564464)
Other time (%) = 0.0292252 (60.2649)

Nlocal:    33.75 ave 42 max 22 min
Histogram: 1 0 1 0 0 2 0 1 1 2
Nghost:    23.375 ave 30 max 14 min
Histogram: 1 0 1 0 0 2 1 0 1 2
Neighs:    52.25 ave 69 max 27 min
Histogram: 1 0 1 0 1 0 1 1 1 2

Total # of neighbors = 418
Ave neighs/atom = 1.54815
Neighbor list builds = 176
Dangerous builds = 0

#undump		1
unfix           soft
unfix		1
unfix		2

# add small particles as hi density lattice

region		plane block INF INF INF INF -0.001 0.001 units box
lattice		sq 85.0
Lattice spacing in x,y,z = 0.108465 0.108465 0.108465
create_atoms	2 region plane
Created 60025 atoms

set		type 2 mass 0.1
  60025 settings made for mass
group		small type 2
60025 atoms in group small
velocity	small create 1.0 593849 loop geom

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.5

delete_atoms	overlap 0.5 small big
Deleted 16305 atoms, new total = 43990

# SRD run

reset_timestep	0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

communicate	multi group big vel yes
neigh_modify	include big

# no pairwise interactions with small particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones
# if comment out, big particles won't see SRD particles

timestep	0.001

fix		1 big rigid molecule
30 rigid bodies with 270 atoms
fix	        2 small srd 20 big 1.0 0.25 49894 shift yes 54979 		  search 0.2 collision slip inside ignore overlap yes
fix		3 small viscosity 10 x y 50
fix		4 all enforce2d

# diagnostics

compute		tbig big temp/sphere
variable	pebig equal pe*atoms/count(big)
variable	ebig equal etotal*atoms/count(big)
thermo_style	custom step temp f_2[8] etotal v_pebig v_ebig press 		f_2[1] f_2[2] f_2[3] f_2[4] f_2[5] 		f_2[6] f_2[7] f_2[8] f_2[9] f_2[10] f_2[11] f_2[12]

thermo_modify	temp tbig
WARNING: Temperature for thermo pressure is not for group all (../thermo.cpp:439)
thermo		1000

#dump		1 all atom 1000 dump.star.mp

#dump		1 all image 1000 image.*.jpg type type zoom 1.6
#dump_modify	1 pad 6 adiam 1 1 adiam 2 0.2

run		100000
SRD info:
  SRD/big particles = 43720 270
  big particle diameter max/min = 1 1
  SRD temperature & lamda = 1 0.0632456
  SRD max distance & max velocity = 0.252982 12.6491
  SRD grid counts: 106 106 1
  SRD grid size: request, actual (xyz) = 0.25, 0.250819 0.250819 1
  SRD per actual grid cell = 5.55866
  SRD viscosity = 0.235582
  big/SRD mass density ratio = 0.144099
WARNING: Fix srd grid size > 1/4 of big particle diameter (../fix_srd.cpp:2875)
  # of rescaled SRD velocities = 0
  ave/max small velocity = 4.19085 7.72582
  ave/max big velocity = 2.20262 5.4168
Memory usage per processor = 7.83759 Mbytes
Step Temp 2[8] TotEng pebig ebig Press 2[1] 2[2] 2[3] 2[4] 2[5] 2[6] 2[7] 2[8] 2[9] 2[10] 2[11] 2[12] 
       0    18.299191            0   0.25067776    37.859815    40.841906    5.7680841            0            0            0            0            0            0            0            0            0            0            0            0 
    1000    1.3197888         8196    0.2296966    37.208454     37.42353    7.4694369        14388           59           59            0          707        57680        11236         8196    1.0259754            0            5            0 
    2000    1.5789784         8192   0.22993088    37.204387    37.461702    7.6252927        14352           56           56            0         1521        57680        11236         8192    1.0168955            0            7            0 
    3000     1.286186         8153    0.2296947    37.213621    37.423222    8.8624394        14533           73           73            0         2299        57680        11236         8153    1.0109574            0            7            0 
    4000    2.0862082         8194   0.23044604     37.20566    37.545635    7.8064365        14228           48           48            0         3068        57680        11236         8194    1.0046224            0            7            0 
    5000     1.892401         8172   0.23019301    37.196017    37.504409    7.9041579        14290           55           55            0         3866        57680        11236         8172     1.005673            0            7            0 
    6000    2.1063411         8138   0.23041636    37.197543    37.540799    4.8468885        13803           47           47            0         4638        57680        11236         8138    1.0083722            0            7            0 
    7000    2.3549938         8174   0.23071159    37.205123      37.5889    6.5703154        13773           58           58            0         5398        57680        11236         8174    1.0039365            0            7            0 
    8000    3.0660305         8216   0.23155654    37.226914    37.726563    11.977404        13898           65           65            0         6180        57680        11236         8216   0.99586836            0            7            0 
    9000    3.1510761         8203   0.23143756     37.19367    37.707178    7.2978028        13815           54           54            0         6985        57680        11236         8203   0.99794556            0            7            0 
   10000    2.7472522         8196   0.23096076    37.181796    37.629496    11.336568        14012           59           59            0         7812        57680        11236         8196   0.99210203            0           11            0 
   11000    2.1776587         8186   0.23038876    37.181424    37.536302    9.2106614        14063           64           64            0         8627        57680        11236         8186     1.003993            0           11            0 
   12000    3.0146734         8196    0.2312123    37.179198    37.670478    5.9303705        14077           60           60            0         9436        57680        11236         8196   0.98496016            0           23            0 
   13000    3.0029829         8179   0.23150759    37.229214    37.718589    7.3329148        14116           74           74            0        10339        57680        11236         8179    1.0039911            0           23            0 
   14000    3.2942972         8191   0.23166868    37.207985    37.744833    9.6428846        14019           56           57            0        11290        57680        11236         8191   0.99410574            0           23            0 
   15000    3.8480961         8213   0.23228155    37.217589    37.844686    2.1025549        13746           68           68            0        12175        57680        11236         8213    1.0011325            0           23            0 
   16000    3.2573043         8195    0.2316418    37.209634    37.740454    8.1255708        13682           55           55            0        13104        57680        11236         8195    1.0061399            0           23            0 
   17000    3.3579037         8186    0.2315443    37.177356     37.72457    9.8606039        13833           54           54            0        14034        57680        11236         8186     1.004156            0           23            0 
   18000    4.7903055         8194   0.23307181    37.192799    37.973441    3.8090185        13914           55           55            1        15012        57680        11236         8194   0.98633014            0           23            0 
   19000    4.4696839         8183   0.23293212    37.222288    37.950681    7.1931333        13499           54           54            0        15960        57680        11236         8183   0.98359656            0           23            0 
   20000    5.0239019         8126   0.23355887    37.234085    38.052794    5.1504203        13600           58           58            0        16972        57680        11236         8126   0.98555755            0           23            0 
   21000    4.6595948         8155   0.23275722    37.162845    37.922186    9.0375076        13965           73           74            0        17966        57680        11236         8155   0.99574348            0           23            0 
   22000     4.043444         8124   0.23247599    37.217434    37.876366    3.9265975        13584           53           53            2        18989        57680        11236         8124    0.9943952            0           23            0 
   23000    4.9981028         8127   0.23314549    37.170939    37.985445    4.2352191        13589           47           47            0        19958        57680        11236         8127   0.99276741            0           47            0 
   24000    4.7542655         8145   0.23295434    37.179533    37.954302     7.365415        13753           51           51            0        20955        57680        11236         8145   0.99024306            0           47            0 
   25000    4.2987054         8177   0.23252979    37.184601    37.885131    10.735771        13536           58           58            0        21994        57680        11236         8177   0.99215977            0           47            0 
   26000    4.4136261         8170   0.23331629    37.294015    38.013272     14.25925        13842           58           58            0        22979        57680        11236         8170   0.99283174            0           47            0 
   27000    4.0546007         8173   0.23283443    37.274016    37.934766      6.22969        13877           51           51            0        23997        57680        11236         8173   0.98496361            0           47            0 
   28000    4.5919614         8151   0.23364384    37.318319    38.066638    4.9917488        13836           60           61            1        25071        57680        11236         8151   0.99390956            0           47            0 
   29000    4.8025535         8189   0.23313849    37.201667    37.984305    4.7895172        13978           46           47            0        26121        57680        11236         8189   0.99018295            0           47            0 
   30000    4.2835226         8139   0.23247583    37.178284     37.87634     8.994878        13988           61           61            0        27141        57680        11236         8139   0.98735471            0           47            0 
   31000    5.4049428         8133   0.23373767    37.201121    38.081927    7.6419291        13771           58           58            0        28207        57680        11236         8133   0.98354883            0           47            0 
   32000    5.0299584         8177   0.23336211    37.201041    38.020738    8.1206741        14036           55           55            0        29303        57680        11236         8177   0.98239013            0           47            0 
   33000    4.2993816         8158   0.23320229     37.29406      37.9947    10.745167        13583           51           51            0        30344        57680        11236         8158   0.98952524            0           47            0 
   34000    5.8334257         8179   0.23458355    37.269109    38.219741    11.094625        13921           62           62            0        31432        57680        11236         8179   0.98822406            0           47            0 
   35000     6.481318         8168   0.23501133    37.233224    38.289439    7.9397445        13942           56           56            0        32518        57680        11236         8168   0.98830425            0           47            0 
   36000     4.967891         8186   0.23366927    37.261199    38.070782    8.3979019        13952           51           51            0        33626        57680        11236         8186   0.99579665            0           47            0 
   37000    5.3458808         8145    0.2337339    37.210132    38.081312    5.4177865        13659           55           55            0        34715        57680        11236         8145    1.0009582            0           47            0 
   38000    6.3597955         8159   0.23479285    37.217431    38.253842    6.1408411        13754           55           56            0        35754        57680        11236         8159   0.98853252            0           47            0 
   39000    6.1217173         8195   0.23447066    37.203737     38.20135    9.6016075        13756           70           70            0        36807        57680        11236         8195   0.98652299            0           47            0 
   40000    5.0218059         8159   0.23370899    37.258886    38.077254    6.6460004        13603           56           56            1        37933        57680        11236         8159   0.98674585            0           47            0 
   41000    5.5873722         8138   0.23429215     37.26173    38.172265    1.4183057        13634           51           52            1        39050        57680        11236         8138   0.98833769            0           47            0 
   42000    5.5502013         8170   0.23405343    37.228895    38.133372    7.8338637        13913           72           72            0        40105        57680        11236         8170   0.99124609            0           47            0 
   43000    4.6854143         8161   0.23326283    37.241013    38.004562     7.857085        13759           48           48            0        41187        57680        11236         8161   0.99649848            0           47            0 
   44000    6.3172352         8180    0.2348893    37.240081    38.269557     12.59288        13810           55           55            0        42292        57680        11236         8180   0.99164669            0           47            0 
   45000    6.1213322         8166   0.23449878    37.208381    38.205931    6.3760889        13854           48           49            0        43406        57680        11236         8166   0.98981447            0           47            0 
   46000    5.0015874         8195   0.23354809    37.235965    38.051038    10.992836        13962           62           62            0        44527        57680        11236         8195   0.99128184            0           47            0 
   47000    5.0499615         8190   0.23376151    37.262854    38.085811    8.7985849        14105           64           64            0        45653        57680        11236         8190   0.99020272            0           47            0 
   48000     5.202255         8170   0.23400688    37.278013    38.125788    4.7389097        13754           51           51            0        46705        57680        11236         8170   0.98792999            0           47            0 
   49000    5.6144741         8167   0.23429848    37.258346    38.173297    6.3247626        13953           51           51            1        47846        57680        11236         8167   0.99270232            0           47            0 
   50000    6.3027505         8145    0.2347122    37.213588    38.240703    6.4424496        13843           59           59            0        49061        57680        11236         8145   0.99810926            0           47            0 
   51000    5.2050769         8154   0.23390178     37.26043    38.108665    6.6143765        13999           51           51            0        50075        57680        11236         8154   0.99525977            0           47            0 
   52000    5.4749884         8175   0.23418567    37.262697    38.154917    8.7256782        13916           51           51            0        51249        57680        11236         8175   0.99508289            0           47            0 
   53000    5.1367735         8158   0.23393299    37.276645    38.113748    9.3248422        13910           41           41            0        52381        57680        11236         8158   0.98956839            0           47            0 
   54000    4.8680584         8211   0.23402832    37.335968    38.129281    4.8979582        14214           63           64            0        53439        57680        11236         8211   0.98838908            0           47            0 
   55000    4.6223848         8167   0.23347097    37.285196    38.038473    6.1898955        14162           46           46            0        54504        57680        11236         8167   0.97935238            0           47            0 
   56000    4.9075747         8168   0.23409393    37.340218    38.139971     12.20686        13980           60           60            0        55540        57680        11236         8168   0.99885966            0           47            0 
   57000    4.8736147         8143   0.23354696    37.256636    38.050854    3.9348529        13857           59           59            0        56680        57680        11236         8143   0.98434054            0           47            0 
   58000    5.6134201         8162   0.23393276    37.198932    38.113711    3.7493067        13866           55           55            2        57767        57680        11236         8162   0.99041155            0           47            0 
   59000     5.440371         8197   0.23353392    37.162151     38.04873    4.1297786        13748           67           67            0        58894        57680        11236         8197   0.98824623            0           47            0 
   60000    5.2754075         8148   0.23359083    37.198307    38.058003    7.1427242        13781           55           55            0        60028        57680        11236         8148    0.9831827            0           47            0 
   61000    5.8228233         8153   0.23438274     37.23812    38.187025    8.8839625        14019           48           48            0        61204        57680        11236         8153   0.98566731            0           47            0 
   62000    5.7623285         8129   0.23480056    37.316052    38.255098     9.992341        13791           67           68            0        62385        57680        11236         8129   0.97338459            0           47            0 
   63000     6.095315         8178   0.23455792    37.222257    38.215567    10.722535        14210           54           54            0        63448        57680        11236         8178   0.98135973            0           47            0 
   64000    5.2494942         8189   0.23380158    37.236866    38.092339    4.4010329        13869           51           51            0        64538        57680        11236         8189   0.98071569            0           47            0 
   65000    5.6534858         8151   0.23405328    37.212039    38.133348    8.9144953        14065           53           53            0        65661        57680        11236         8151   0.99589337            0           47            0 
   66000    5.3999138         8165   0.23453061     37.33113    38.211116    7.3102657        13994           61           62            0        66785        57680        11236         8165   0.98715854            0           47            0 
   67000    6.3619419         8183   0.23459518    37.184875    38.221636    4.0425684        13859           49           49            0        67944        57680        11236         8183   0.98479883            0           47            0 
   68000    6.2170116         8157   0.23470153    37.225822    38.238965    9.3090925        13598           50           50            0        69121        57680        11236         8157   0.98683618            0           47            0 
   69000    6.8545121         8179   0.23542272    37.239433    38.356465    9.4175179        13911           59           59            0        70316        57680        11236         8179   0.99828763            0           47            0 
   70000    5.1476232         8154   0.23389653    37.268937    38.107809    7.6438157        13882           55           55            0        71380        57680        11236         8154   0.99088995            0           47            0 
   71000    5.9284504         8161   0.23499148    37.320087    38.286205    9.1242845        13968           60           60            0        72478        57680        11236         8161   0.98627289            0           47            0 
   72000    5.8044136         8180   0.23473312    37.298207    38.244111    6.6084298        14066           56           56            0        73653        57680        11236         8180   0.97959812            0           47            0 
   73000    5.3690655         8148   0.23424676    37.289911     38.16487    8.7025002        14433           55           55            1        74740        57680        11236         8148   0.97949605            0           47            0 
   74000    4.8144157         8192   0.23361625    37.277572    38.062144    7.6685178        14425           58           58            1        75918        57680        11236         8192   0.98949387            0           47            0 
   75000    4.9424688         8143   0.23362551    37.258213    38.063652    5.5882668        13938           42           42            0        77080        57680        11236         8143   0.99602516            0           47            0 
   76000    6.3017203         8178   0.23500247    37.261048    38.287995    5.2760401        13952           47           47            0        78240        57680        11236         8178   0.98484281            0           47            0 
   77000    5.3086333         8208   0.23389726    37.242817    38.107928     4.034731        14052           47           47            0        79331        57680        11236         8208    0.9896033            0           47            0 
   78000    6.1152265         8157   0.23546115    37.366171    38.362726    11.521489        13980           58           58            0        80446        57680        11236         8157   0.98562154            0           47            0 
   79000    6.5034669         8173   0.23569944    37.341726     38.40155    5.0939756        14030           74           74            0        81663        57680        11236         8173   0.98837711            0           47            0 
   80000    6.1688245         8182   0.23495003    37.274162    38.279451    6.3337593        14292           50           50            0        82872        57680        11236         8182   0.99316806            0           47            0 
   81000    6.3818913         8189   0.23516767    37.274899    38.314911    9.0232294        14259           56           56            0        84072        57680        11236         8189   0.98467136            0           47            0 
   82000     6.502454         8171   0.23498158    37.224932    38.284591    7.6685939        13970           63           63            0        85190        57680        11236         8171   0.99511647            0           47            0 
   83000    7.2245962         8142   0.23564338    37.215075    38.392416    6.0363083        13789           61           61            0        86416        57680        11236         8142   0.99223565            0           47            0 
   84000    6.3529888         8192   0.23477435    37.215526    38.250828    7.2109855        14062           52           52            0        87555        57680        11236         8192   0.98623425            0           47            0 
   85000    6.5185235         8177   0.23516364    37.251976    38.314254     5.266764        14325           52           53            0        88732        57680        11236         8177   0.97895516            0           47            0 
   86000     5.742959         8170   0.23432816    37.242243    38.178133    6.0834874        13922           48           48            0        89836        57680        11236         8170   0.99203022            0           47            0 
   87000     6.548676         8177   0.23495538    37.213132    38.280324    6.2502744        14147           48           48            0        91035        57680        11236         8177   0.98829721            0           47            0 
   88000    5.9500587         8193   0.23446634    37.231006    38.200645    6.2196893        13960           44           44            0        92206        57680        11236         8193   0.98956808            0           47            0 
   89000    5.0591447         8174   0.23386574    37.278339    38.102793    11.164066        14071           54           54            0        93437        57680        11236         8174   0.99827748            0           47            0 
   90000    6.4930795         8181   0.23544182    37.301445    38.359576    6.6167028        14183           63           63            1        94640        57680        11236         8181   0.99559871            0           47            0 
   91000     6.489104         8187   0.23523152    37.267829    38.325313    6.4932786        14223           51           51            1        95718        57680        11236         8187   0.99090796            0           47            0 
   92000    6.3543839         8184   0.23502776    37.256587    38.292116    7.1553807        14265           66           66            1        96903        57680        11236         8184   0.98979354            0           47            0 
   93000    5.3818591         8195   0.23393122    37.236417     38.11346    7.9445503        14327           70           70            0        98138        57680        11236         8195    1.0030252            0           47            0 
   94000    5.6818206         8171    0.2343696    37.258958    38.184885    5.7311019        13943           63           63            0        99306        57680        11236         8171   0.99691591            0           47            0 
   95000    4.8295204         8160   0.23371941    37.291918    38.078951    4.5703653        13682           48           48            1       100491        57680        11236         8160    1.0078235            0           47            0 
   96000    6.7415726         8191   0.23539566    37.253429    38.352056    11.837168        13783           53           53            1       101761        57680        11236         8191    1.0010125            0           49            0 
   97000    6.5298825         8160    0.2354153    37.291126    38.355255    7.6012271        13688           65           65            0       103010        57680        11236         8160   0.99694671            0           49            0 
   98000    6.2804965         8175   0.23496877    37.259015    38.282504    5.4636503        14041           55           55            0       104259        57680        11236         8175    1.0042653            0           49            0 
   99000    5.7684681         8173    0.2344998     37.26605    38.206096    1.7807753        14082           58           59            0       105418        57680        11236         8173   0.99124491            0           49            0 
  100000    6.1371898         8170   0.23495644     37.28036    38.280495    7.7665232        13908           53           53            0       106633        57680        11236         8170   0.98281247            0           49            0 
Loop time of 34.1892 on 8 procs for 100000 steps with 43990 atoms

Pair  time (%) = 0.361362 (1.05695)
Neigh time (%) = 2.01143 (5.88324)
Comm  time (%) = 2.27139 (6.64359)
Outpt time (%) = 0.00694269 (0.0203067)
Other time (%) = 29.5381 (86.3959)

Nlocal:    5498.75 ave 6478 max 4726 min
Histogram: 2 0 1 0 1 2 1 0 0 1
Nghost:    52.875 ave 59 max 44 min
Histogram: 1 0 1 0 1 0 1 0 2 2
Neighs:    186.25 ave 293 max 81 min
Histogram: 1 0 1 3 0 0 1 0 0 2

Total # of neighbors = 1490
Ave neighs/atom = 0.0338713
Neighbor list builds = 5000
Dangerous builds = 0

Please see the log.cite file for references relevant to this simulation

