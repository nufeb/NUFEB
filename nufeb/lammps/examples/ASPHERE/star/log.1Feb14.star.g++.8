LAMMPS (1 Feb 2014)
# SRD diffusion demo - rigid star particles

units		lj
atom_style	sphere
atom_modify	map array first big
dimension	2

# read in clusters of rigid bodies

fix             molprop all property/atom mol
read_data	data.star fix molprop NULL Molecules
  orthogonal box = (-13.2934 -13.2934 -0.5) to (13.2934 13.2934 0.5)
  4 by 2 by 1 MPI processor grid
  reading atoms ...
  270 atoms

set		type 1 mass 1.0
  270 settings made for mass
group		big type 1
270 atoms in group big
velocity	big create 1.44 87287 loop geom

# equilibrate big particles

pair_style	soft 1.12
pair_coeff	1 1 0.0
pair_coeff	2 2 0.0 0.0
pair_coeff	1 2 0.0 0.0

variable        prefactor equal ramp(0,60)
fix             soft all adapt 1 pair soft a * * v_prefactor

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

fix		1 big rigid molecule
30 rigid bodies with 270 atoms
fix		2 all enforce2d

#dump		1 all atom 10 dump.star.equil

thermo		100
run		1000
Memory usage per processor = 2.64859 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            0            0            0            0   0.24721146 
     100            0     3.291475            0     3.291475   0.69158089 
     200            0    4.6176595            0    4.6176595   0.71737945 
     300            0    7.0921814            0    7.0921814    1.2163497 
     400            0    8.3666709            0    8.3666709   0.50645957 
     500            0    10.630838            0    10.630838   0.72764487 
     600            0     12.42157            0     12.42157    1.0130599 
     700            0    14.349074            0    14.349074   0.74795509 
     800            0    16.464746            0    16.464746     1.054549 
     900            0    18.253108            0    18.253108   0.51551753 
    1000            0    20.699563            0    20.699563    1.8084662 
Loop time of 0.040709 on 8 procs for 1000 steps with 270 atoms

Pair  time (%) = 0.00249004 (6.11668)
Neigh time (%) = 0.000995547 (2.44552)
Comm  time (%) = 0.0116902 (28.7165)
Outpt time (%) = 0.000232756 (0.571755)
Other time (%) = 0.0253005 (62.1496)

Nlocal:    33.75 ave 42 max 22 min
Histogram: 1 0 1 0 0 2 0 1 1 2
Nghost:    23.375 ave 30 max 14 min
Histogram: 1 0 1 0 0 2 1 0 1 2
Neighs:    52.25 ave 69 max 27 min
Histogram: 1 0 1 0 1 0 1 1 1 2

Total # of neighbors = 418
Ave neighs/atom = 1.54815
Neighbor list builds = 176
Dangerous builds = 0

#undump		1
unfix           soft
unfix		1
unfix		2

# add small particles as hi density lattice

region		plane block INF INF INF INF -0.001 0.001 units box
lattice		sq 85.0
Lattice spacing in x,y,z = 0.108465 0.108465 0.108465
create_atoms	2 region plane
Created 60025 atoms

set		type 2 mass 0.1
  60025 settings made for mass
group		small type 2
60025 atoms in group small
velocity	small create 1.0 593849 loop geom

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.5

delete_atoms	overlap 0.5 small big
Deleted 16305 atoms, new total = 43990

# SRD run

reset_timestep	0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

communicate	multi group big vel yes
neigh_modify	include big

# no pairwise interactions with small particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones
# if comment out, big particles won't see SRD particles

timestep	0.001

fix		1 big rigid molecule
30 rigid bodies with 270 atoms
fix	        2 small srd 20 big 1.0 0.25 49894 shift yes 54979 		  search 0.2 collision slip inside ignore overlap yes
fix		3 all enforce2d

# diagnostics

compute		tbig big temp/sphere
variable	pebig equal pe*atoms/count(big)
variable	ebig equal etotal*atoms/count(big)
thermo_style	custom step temp f_2[8] etotal v_pebig v_ebig press 		f_2[1] f_2[2] f_2[3] f_2[4] f_2[5] 		f_2[6] f_2[7] f_2[8] f_2[9] f_2[10] f_2[11] f_2[12]

thermo_modify	temp tbig
WARNING: Temperature for thermo pressure is not for group all (../thermo.cpp:439)
thermo		1000

#dump		1 all atom 1000 dump.star

#dump		1 all image 1000 image.*.jpg type type zoom 1.6
#dump_modify	1 pad 6 adiam 1 1 adiam 2 0.2

run		100000
SRD info:
  SRD/big particles = 43720 270
  big particle diameter max/min = 1 1
  SRD temperature & lamda = 1 0.0632456
  SRD max distance & max velocity = 0.252982 12.6491
  SRD grid counts: 106 106 1
  SRD grid size: request, actual (xyz) = 0.25, 0.250819 0.250819 1
  SRD per actual grid cell = 5.55866
  SRD viscosity = 0.235582
  big/SRD mass density ratio = 0.144099
WARNING: Fix srd grid size > 1/4 of big particle diameter (../fix_srd.cpp:2875)
  # of rescaled SRD velocities = 0
  ave/max small velocity = 4.19085 7.72582
  ave/max big velocity = 2.20262 5.4168
Memory usage per processor = 7.83759 Mbytes
Step Temp 2[8] TotEng pebig ebig Press 2[1] 2[2] 2[3] 2[4] 2[5] 2[6] 2[7] 2[8] 2[9] 2[10] 2[11] 2[12] 
       0    18.299191            0   0.25067776    37.859815    40.841906    5.7680841            0            0            0            0            0            0            0            0            0            0            0            0 
    1000    1.3155168         8201   0.22979575    37.225304    37.439685    8.9588433        14577           56           56            0          687        57680        11236         8201    1.0283377            0            5            0 
    2000   0.82290815         8187   0.22918912    37.206746    37.340849    6.0607727        14326           56           56            0         1524        57680        11236         8187    1.0127464            0            5            0 
    3000   0.99928391         8168   0.22921842    37.182777    37.345623    10.268998        14389           68           68            0         2274        57680        11236         8168     1.023497            0            5            0 
    4000    1.0348458         8200   0.22920437    37.174693    37.343335    9.8954805        14335           51           51            0         3047        57680        11236         8200    1.0156984            0            5            0 
    5000    1.1496765         8199   0.22939095    37.186379    37.373733    8.0143223        14444           74           74            0         3868        57680        11236         8199    1.0104858            0            5            0 
    6000   0.91767381         8225    0.2292466    37.200668    37.350215    8.6189298        14131           61           61            0         4594        57680        11236         8225    1.0147272            0            5            0 
    7000   0.74806752         8203   0.22888634    37.169611    37.291518    9.8613421        14121           53           53            1         5322        57680        11236         8203    1.0198289            0           19            0 
    8000    1.1177867         8213   0.22924801    37.168286    37.350444     7.911691        14380           62           62            0         6024        57680        11236         8213    1.0066799            0           19            0 
    9000    1.1258411         8209   0.22939703    37.191253    37.374723    6.7377179        14350           51           51            0         6821        57680        11236         8209    1.0081225            0           19            0 
   10000    1.0597344         8182   0.22919436    37.169006    37.341703    9.7769156        14372           48           48            0         7543        57680        11236         8182    1.0099373            0           19            0 
   11000    1.3337199         8159   0.22943046    37.162823     37.38017    6.0897666        14359           58           58            0         8245        57680        11236         8159    1.0046221            0           19            0 
   12000    1.0280975         8184   0.22894286    37.133186    37.300728     2.555317        14162           51           51            0         8935        57680        11236         8184    1.0010306            0           19            0 
   13000    1.2318533         8190   0.22921487    37.144299    37.345045    6.1739989        14285           64           64            0         9634        57680        11236         8190    1.0138112            0           19            0 
   14000    1.1851991         8215   0.22915708    37.142485    37.335629    7.8380175        14151           66           66            0        10407        57680        11236         8215    1.0008011            0           19            0 
   15000   0.89853218         8214   0.22897294    37.159201    37.305628    4.0743953        14077           61           61            0        11069        57680        11236         8214    1.0041341            0           19            0 
   16000    1.0295974         8176   0.22891205    37.127921    37.295708    8.7527117        14000           48           48            0        11832        57680        11236         8176    1.0089653            0           23            0 
   17000    1.1793664         8219   0.22906268    37.128056    37.320249    5.2583304        14268           57           57            0        12490        57680        11236         8219    1.0157079            0           23            0 
   18000   0.90486919         8180   0.22891008    37.147927    37.295387    4.8498125        13939           64           64            0        13154        57680        11236         8180   0.99700921            0           23            0 
   19000   0.81486319         8219   0.22881911    37.147773    37.280566    1.6338041        13934           59           59            1        13861        57680        11236         8219    1.0099189            0           23            0 
   20000    1.0146287         8180   0.22896254    37.138587    37.303934    2.1682593        14057           45           45            0        14593        57680        11236         8180    1.0009466            0           23            0 
   21000    1.3031463         8164   0.22920646    37.131309    37.343674     6.570906        13944           65           65            0        15323        57680        11236         8164   0.98955239            0           23            0 
   22000    1.1258162         8174   0.22915084    37.151147    37.334613    9.0817519        14052           56           56            0        16042        57680        11236         8174    1.0083228            0           23            0 
   23000    1.1421222         8217   0.22906722    37.134865    37.320989    8.0529401        14143           66           66            0        16797        57680        11236         8217    1.0111161            0           23            0 
   24000   0.77402445         8168   0.22883056    37.156294    37.282431    6.8609899        14258           62           62            0        17559        57680        11236         8168    1.0080535            0           23            0 
   25000   0.94006632         8215   0.22879533    37.123496    37.276692    3.8570839        14446           48           48            0        18267        57680        11236         8215    1.0087899            0           23            0 
   26000    1.2808563         8192   0.22933112    37.155253    37.363985    5.3591484        13960           54           54            1        19004        57680        11236         8192    1.0101851            0           79            0 
   27000    1.0266075         8171   0.22898652    37.140542    37.307841    2.9961422        14049           56           56            1        19683        57680        11236         8171   0.99950217            0           79            0 
   28000   0.98185838         8199   0.22867129    37.096475    37.256481    12.080529        14106           61           62            0        20417        57680        11236         8199    1.0026548            0           79            0 
   29000   0.96921352         8192   0.22861802    37.089856    37.247802     8.257635        13891           63           64            0        21169        57680        11236         8192    1.0128041            0           79            0 
   30000    1.0107665         8223   0.22866616    37.090929    37.255646    9.4280788        14021           61           61            1        21863        57680        11236         8223    1.0034994            0           79            0 
   31000    1.1859435         8195   0.22877222    37.079661    37.272926    7.3863353        14093           78           78            0        22480        57680        11236         8195    0.9945582            0           79            0 
   32000    1.2951374         8172   0.22897044    37.094161     37.30522    6.4322363        13792           52           52            0        23151        57680        11236         8172    1.0026092            0           79            0 
   33000   0.82899919         8176   0.22823894    37.050944    37.186041   0.60210493        13797           62           62            0        23903        57680        11236         8176    1.0051075            0           79            0 
   34000   0.96685714         8165   0.22828901    37.036637    37.194199    8.1409866        13837           50           50            0        24591        57680        11236         8165    1.0157895            0           79            0 
   35000   0.95645753         8206   0.22833008    37.045022    37.200889    8.9956195        14130           63           63            0        25340        57680        11236         8206    1.0030424            0           79            0 
   36000    1.2933379         8197   0.22879201    37.065383     37.27615    8.3938627        13978           80           80            0        26085        57680        11236         8197    1.0094497            0           79            0 
   37000    1.1511434         8176   0.22861016    37.058929    37.246523    4.9481995        13856           49           49            1        26759        57680        11236         8176    1.0063722            0           79            0 
   38000   0.93310274         8181   0.22837532    37.056199     37.20826    5.9575015        13949           51           51            0        27445        57680        11236         8181    1.0152607            0           79            0 
   39000    1.0352467         8215   0.22861437    37.078501    37.247208    9.8519532        14109           69           69            0        28245        57680        11236         8215     1.005523            0           79            0 
   40000    1.2696427         8193   0.22885162    37.078957    37.285862    8.4680587        13931           54           55            0        28960        57680        11236         8193    1.0014074            0           79            0 
   41000    1.3270531         8193   0.22909573    37.109374    37.325634    4.3731598        14115           62           62            0        29668        57680        11236         8193    1.0022493            0           79            0 
   42000    1.3650738         8183   0.22911257    37.105921    37.328377    6.6345101        13659           52           52            0        30400        57680        11236         8183    1.0145834            0           79            0 
   43000    1.0780084         8209   0.22855316     37.06156    37.237235    5.5147087        14062           52           52            0        31092        57680        11236         8209    1.0031365            0           79            0 
   44000   0.96146724         8193   0.22846546    37.066263    37.222946    9.7967735        13699           56           56            0        31771        57680        11236         8193    1.0072364            0           79            0 
   45000    1.1733618         8200    0.2286481    37.061489    37.252703    9.8058881        13967           51           52            0        32532        57680        11236         8200    1.0068663            0           79            0 
   46000   0.94784989         8211   0.22845052    37.066048    37.220513    5.8834756        13944           34           35            0        33213        57680        11236         8211    1.0080225            0           79            0 
   47000    1.2354771         8207   0.22859598    37.042876    37.244213    6.1458407        13851           56           56            0        33886        57680        11236         8207    1.0151781            0           79            0 
   48000    1.0834097         8164   0.22835968    37.029157    37.205712    6.7378814        13944           56           56            0        34578        57680        11236         8164    1.0128575            0           79            0 
   49000    0.9386786         8208   0.22837254    37.054838    37.207808    5.0809383        13618           53           53            0        35328        57680        11236         8208    1.0045622            0           79            0 
   50000     1.047176         8154   0.22859126    37.072791    37.243442    4.8016981        13847           55           55            0        36059        57680        11236         8154    1.0005378            0           79            0 
   51000    1.0943417         8222   0.22844191    37.040773     37.21911    7.9359541        13897           61           61            0        36711        57680        11236         8222    1.0036343            0           79            0 
   52000    1.2811259         8200   0.22871149    37.054255    37.263031    4.9958687        13744           56           56            0        37402        57680        11236         8200    1.0049188            0           79            0 
   53000    1.0997162         8218   0.22853173     37.05453    37.233743    4.6772882        13967           65           65            0        38082        57680        11236         8218    1.0054533            0           79            0 
   54000   0.97625718         8185    0.2283994     37.05309    37.212184    5.9026406        13741           69           69            0        38761        57680        11236         8185   0.99393606            0           79            0 
   55000   0.97919465         8192   0.22835234    37.044944    37.204516    6.8419755        13990           58           58            0        39453        57680        11236         8192    1.0103052            0           79            0 
   56000   0.86300824         8181   0.22842164    37.075169    37.215808    6.8288348        13751           57           57            0        40118        57680        11236         8181   0.99683099            0           79            0 
   57000   0.89429559         8181   0.22851743    37.085677    37.231414     9.378853        13746           72           72            0        40730        57680        11236         8181    1.0086882            0           79            0 
   58000    1.0853441         8172   0.22857719    37.064279     37.24115    7.4580035        13869           58           58            1        41462        57680        11236         8172    1.0092141            0           79            0 
   59000    1.0149632         8199   0.22868187    37.092803    37.258205    8.2913359        13720           54           54            0        42159        57680        11236         8199    1.0082738            0           79            0 
   60000   0.99214038         8241   0.22871146    37.101344    37.263026    7.9905647        13776           67           67            0        42858        57680        11236         8241    1.0027929            0           79            0 
   61000   0.95721926         8211    0.2285241     37.07651    37.232501    11.837258        13907           62           62            0        43565        57680        11236         8211    1.0201117            0           79            0 
   62000    1.1457294         8195   0.22866514    37.068769     37.25548    9.7934944        13796           40           40            1        44292        57680        11236         8195     1.005192            0           79            0 
   63000    1.1096177         8193   0.22863037    37.068989    37.249815    8.0809047        13984           54           55            0        44986        57680        11236         8193    1.0076438            0           79            0 
   64000    1.1643495         8168   0.22860016    37.055147    37.244893    4.7376475        13857           50           50            1        45657        57680        11236         8168     1.002011            0           79            0 
   65000    1.2172585         8201   0.22845803    37.023368    37.221736    8.9744616        13610           53           53            0        46295        57680        11236         8201    1.0033999            0           79            0 
   66000   0.99924611         8189   0.22807344    36.996237    37.159077    8.5854786        13849           49           49            0        46944        57680        11236         8189     1.015528            0           79            0 
   67000    1.2543542         8165   0.22831075    36.993327     37.19774    5.0081411        13906           57           58            1        47666        57680        11236         8165    1.0189753            0           79            0 
   68000    1.0360874         8205   0.22812149     36.99806    37.166904    2.2431831        13650           52           52            0        48363        57680        11236         8205    1.0076864            0           79            0 
   69000   0.69755552         8218   0.22766249    36.978446    37.092121    4.2769033        13654           51           51            0        49044        57680        11236         8218     1.009863            0           79            0 
   70000   0.90921994         8167   0.22796236    36.992809    37.140978    9.3555738        13927           52           52            0        49793        57680        11236         8167    1.0015807            0           79            0 
   71000   0.95608837         8177   0.22797832    36.987772    37.143579    8.0740708        13612           63           63            0        50464        57680        11236         8177    1.0097491            0           79            0 
   72000    1.0374855         8192   0.22803745     36.98414    37.153212    4.4789755        13561           52           52            0        51127        57680        11236         8192   0.99496724            0           79            0 
   73000   0.90636338         8214   0.22783374     36.97232    37.120024    9.3364171        13598           53           53            0        51799        57680        11236         8214    1.0078219            0           79            0 
   74000    1.1869638         8179   0.22834625    37.010094    37.203525    4.8292929        13771           51           51            0        52500        57680        11236         8179   0.98865277            0           79            0 
   75000    1.0177351         8188   0.22826506    37.024443    37.190296    5.1808505        13508           55           55            0        53183        57680        11236         8188   0.99903558            0           79            0 
   76000     1.062496         8230   0.22820987    37.008158    37.181305    8.1032524        13769           58           58            0        53864        57680        11236         8230   0.99397021            0           79            0 
   77000    0.9762027         8131   0.22831271    37.038975     37.19806    10.309798        13787           47           47            0        54553        57680        11236         8131    1.0066289            0           79            0 
   78000    1.0688533         8160   0.22855677     37.06364    37.237824    7.4800503        13224           58           58            0        55248        57680        11236         8160    1.0073477            0           79            0 
   79000    1.2598513         8151   0.22844942    37.015024    37.220333    7.4724924        13859           63           63            0        55911        57680        11236         8151    1.0065168            0           79            0 
   80000    1.1044575         8176   0.22834306    37.023019    37.203005    3.0142586        13579           62           62            0        56611        57680        11236         8176    1.0008704            0           79            0 
   81000    1.2756491         8205   0.22853748    37.026797     37.23468     6.434309        13702           52           52            0        57313        57680        11236         8205    1.0058366            0           79            0 
   82000    1.1276926         8193   0.22857049    37.056287    37.240059    11.825248        13621           63           63            0        58011        57680        11236         8193    1.0113537            0           79            0 
   83000   0.96941691         8173   0.22824759    37.029471     37.18745    2.9152799        13478           48           49            0        58712        57680        11236         8173    1.0168819            0           79            0 
   84000    1.0770325         8186   0.22821292    37.006285    37.181802    5.0626072        13733           60           61            0        59433        57680        11236         8186    1.0177757            0           79            0 
   85000    1.1959489         8175    0.2284266    37.021719    37.216615    5.3844747        13964           55           55            0        60226        57680        11236         8175     1.007371            0           79            0 
   86000     1.035779         8204   0.22845952    37.053185    37.221979    7.5428558        13713           64           64            0        60982        57680        11236         8204    1.0110801            0           79            0 
   87000    1.1878573         8204   0.22836412    37.012859    37.206436    3.1124447        13655           47           47            0        61668        57680        11236         8204    1.0034968            0           79            0 
   88000   0.98402924         8206   0.22815704    37.012337    37.172698    10.613422        13947           56           56            0        62325        57680        11236         8206    1.0081468            0           79            0 
   89000   0.83763529         8199   0.22807071    37.022127    37.158631    5.4628281        13966           50           50            0        63012        57680        11236         8199   0.99956322            0           79            0 
   90000    1.1976672         8187   0.22849599    37.032745    37.227921    5.5583762        13903           43           43            0        63697        57680        11236         8187    1.0047573            0           79            0 
   91000   0.94863742         8188   0.22818061    37.021945    37.176537     5.157692        13859           46           46            0        64382        57680        11236         8188    1.0041894            0           79            0 
   92000    1.2038427         8172   0.22846103    37.026042    37.222224     6.685059        13675           57           57            0        65081        57680        11236         8172    1.0036906            0           79            0 
   93000   0.95835618         8210   0.22828548    37.037446    37.193622    8.0038227        13826           57           58            0        65761        57680        11236         8210    1.0076646            0           79            0 
   94000    1.2451267         8197   0.22856138    37.035665    37.238575    3.6305666        13918           62           62            0        66462        57680        11236         8197    1.0110913            0           79            0 
   95000   0.82128549         8206   0.22809174    37.028218    37.162057    8.7024273        13817           44           44            0        67185        57680        11236         8206    1.0032224            0           79            0 
   96000   0.83473128         8199   0.22820935     37.04519     37.18122    8.1258155        14167           54           54            0        67912        57680        11236         8199    1.0035561            0           79            0 
   97000   0.98924493         8196   0.22847944    37.064014    37.225225    8.9964529        14039           48           51            0        68608        57680        11236         8196    1.0007515            0           79            0 
   98000    1.1749668         8211   0.22879851    37.085733     37.27721    7.0283734        13850           58           59            0        69305        57680        11236         8211   0.99525651            0           79            0 
   99000    1.3269705         8163   0.22890919    37.078994    37.295241    9.7962294        13885           63           63            0        69994        57680        11236         8163     1.011015            0          107            0 
  100000    1.0020436         8171   0.22867221    37.093336    37.256632    4.9455304        14102           55           56            0        70707        57680        11236         8171    1.0072865            0          107            0 
Loop time of 33.9872 on 8 procs for 100000 steps with 43990 atoms

Pair  time (%) = 0.379981 (1.11801)
Neigh time (%) = 2.01801 (5.93757)
Comm  time (%) = 2.30255 (6.77476)
Outpt time (%) = 0.00694308 (0.0204285)
Other time (%) = 29.2797 (86.1492)

Nlocal:    5498.75 ave 6445 max 4431 min
Histogram: 1 0 0 2 1 1 0 1 1 1
Nghost:    62.5 ave 70 max 57 min
Histogram: 3 0 0 1 1 0 1 0 1 1
Neighs:    207 ave 365 max 92 min
Histogram: 1 1 1 1 2 0 1 0 0 1

Total # of neighbors = 1656
Ave neighs/atom = 0.0376449
Neighbor list builds = 5000
Dangerous builds = 0

Please see the log.cite file for references relevant to this simulation

