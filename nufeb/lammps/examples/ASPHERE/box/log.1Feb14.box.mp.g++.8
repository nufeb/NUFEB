LAMMPS (1 Feb 2014)
# SRD viscosity demo - rigid box particles

units		lj
atom_style	sphere
atom_modify	map array first big
dimension	2

# read in clusters of rigid bodies

fix             molprop all property/atom mol
read_data	data.box fix molprop NULL Molecules
  orthogonal box = (-19.1447 -19.1447 -0.5) to (19.1447 19.1447 0.5)
  4 by 2 by 1 MPI processor grid
  reading atoms ...
  420 atoms

set		type 1 mass 1.0
  420 settings made for mass
group		big type 1
420 atoms in group big
velocity	big create 1.44 87287 loop geom

# equilibrate big particles

pair_style	soft 1.12
pair_coeff	1 1 0.0
pair_coeff	2 2 0.0 0.0
pair_coeff	1 2 0.0 0.0

variable        prefactor equal ramp(0,60)
fix             soft all adapt 1 pair soft a * * v_prefactor

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

fix		1 big rigid molecule
30 rigid bodies with 420 atoms
fix		2 all enforce2d

#dump		1 all atom 10 dump.box.equil

thermo		100
run		1000
Memory usage per processor = 0.443012 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            0            0            0            0    -8.770036 
     100            0    3.4203218            0    3.4203218   0.49351517 
     200            0    5.3315601            0    5.3315601   0.26965614 
     300            0    7.2094878            0    7.2094878   0.43326479 
     400            0    9.2008598            0    9.2008598   0.27649318 
     500            0    11.562353            0    11.562353   0.60730421 
     600            0    13.731564            0    13.731564   0.27272312 
     700            0    15.850142            0    15.850142 0.0032862218 
     800            0    18.395444            0    18.395444    1.0272658 
     900            0      20.3322            0      20.3322  -0.16729762 
    1000            0    22.600716            0    22.600716  -0.13023705 
Loop time of 0.0540034 on 8 procs for 1000 steps with 420 atoms

Pair  time (%) = 0.00388333 (7.1909)
Neigh time (%) = 0.0012731 (2.35743)
Comm  time (%) = 0.0160792 (29.7743)
Outpt time (%) = 0.000274509 (0.508318)
Other time (%) = 0.0324934 (60.169)

Nlocal:    52.5 ave 67 max 35 min
Histogram: 1 1 1 0 1 0 0 1 1 2
Nghost:    30.625 ave 41 max 17 min
Histogram: 1 0 0 1 1 1 2 0 1 1
Neighs:    70.25 ave 90 max 44 min
Histogram: 2 0 0 1 1 0 1 0 0 3

Total # of neighbors = 562
Ave neighs/atom = 1.3381
Neighbor list builds = 158
Dangerous builds = 0

#undump		1
unfix           soft
unfix		1
unfix		2

# add small particles as hi density lattice

region		plane block INF INF INF INF -0.001 0.001 units box
lattice		sq 85.0
Lattice spacing in x,y,z = 0.108465 0.108465 0.108465
create_atoms	2 region plane
Created 124609 atoms

set		type 2 mass 0.1
  124609 settings made for mass
group		small type 2
124609 atoms in group small
velocity	small create 1.0 593849 loop geom

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 1.0

delete_atoms	overlap 1.0 small big
Deleted 51030 atoms, new total = 73999

# SRD run

reset_timestep	0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

communicate	multi group big vel yes
neigh_modify	include big

# no pairwise interactions with small particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones
# if comment out, big particles won't see SRD particles

timestep	0.001

fix		1 big rigid molecule
30 rigid bodies with 420 atoms
fix	        2 small srd 20 big 1.0 0.25 49894 shift yes 54979 		  search 0.2 collision slip inside ignore overlap yes
fix		3 small viscosity 10 x y 50
fix		4 all enforce2d

# diagnostics

compute		tbig big temp/sphere
variable	pebig equal pe*atoms/count(big)
variable	ebig equal etotal*atoms/count(big)
thermo_style	custom step temp f_2[8] etotal v_pebig v_ebig press 		f_2[1] f_2[2] f_2[3] f_2[4] f_2[5] 		f_2[6] f_2[7] f_2[8] f_2[9] f_2[10] f_2[11] f_2[12]

thermo_modify	temp tbig
WARNING: Temperature for thermo pressure is not for group all (../thermo.cpp:439)
thermo		1000

#dump		1 all atom 1000 dump.box.mp

#dump		1 all image 1000 image.*.jpg type type zoom 1.6
#dump_modify	1 pad 6 adiam 1 1 adiam 2 0.2

run		100000
SRD info:
  SRD/big particles = 73579 420
  big particle diameter max/min = 1 1
  SRD temperature & lamda = 1 0.0632456
  SRD max distance & max velocity = 0.252982 12.6491
  SRD grid counts: 153 153 1
  SRD grid size: request, actual (xyz) = 0.25, 0.250257 0.250257 1
  SRD per actual grid cell = 4.05573
  SRD viscosity = 0.229297
  big/SRD mass density ratio = 0.196614
WARNING: Fix srd grid size > 1/4 of big particle diameter (../fix_srd.cpp:2875)
  # of rescaled SRD velocities = 0
  ave/max small velocity = 4.19668 7.72762
  ave/max big velocity = 2.12757 5.83591
Memory usage per processor = 14.2707 Mbytes
Step Temp 2[8] TotEng pebig ebig Press 2[1] 2[2] 2[3] 2[4] 2[5] 2[6] 2[7] 2[8] 2[9] 2[10] 2[11] 2[12] 
       0    27.381112            0   0.25599398    42.234595    45.103092   0.74047865            0            0            0            0            0            0            0            0            0            0            0            0 
    1000    3.0049838        16229   0.24126663      42.1935    42.508307    10.275827        10158           39           39            0          970        90440        23409        16229   0.90908897            0            5            0 
    2000    2.1454941        16282   0.24068985     42.18192    42.406686    8.3551805        10114           39           39            0         1766        90440        23409        16282   0.91411077            0            5            0 
    3000    1.7194781        16297   0.24043991    42.182513    42.362649    9.0500757        10293           35           35            0         2454        90440        23409        16297   0.91613392            0            5            0 
    4000    1.9700398        16189   0.24063155    42.190029    42.396415    11.380017        10043           27           28            0         3083        90440        23409        16189   0.92535621            0            5            0 
    5000    2.2262815        16301   0.24071918    42.178625    42.411854    10.059361        10169           29           29            0         3730        90440        23409        16301   0.92861813            0            5            0 
    6000    2.2291507        16232   0.24063671    42.163793    42.397323     7.276142         9899           40           40            0         4445        90440        23409        16232   0.93275834            0            5            0 
    7000    2.7841984        16212    0.2407729    42.129641    42.421319    10.838996        10144           39           39            0         5148        90440        23409        16212   0.93329636            0            5            0 
    8000    3.1799279        16294   0.24102189    42.132053    42.465189    9.3204165        10068           31           31            0         5897        90440        23409        16294   0.93229671            0            5            0 
    9000    3.6101913        16308   0.24126974    42.130646    42.508857    9.9117415        10113           30           30            0         6716        90440        23409        16308   0.93107227            0            5            0 
   10000    4.1022731        16319   0.24161934    42.140689    42.570451    9.8799373        10205           34           34            0         7480        90440        23409        16319   0.92489062            0            5            0 
   11000    4.2790298        16269    0.2417129    42.138657    42.586936     10.14836        10002           37           37            2         8283        90440        23409        16269   0.92331323            0           10            0 
   12000    4.4299614        16323   0.24179577    42.137445    42.601537    11.786696        10068           37           37            1         9085        90440        23409        16323   0.93507414            0           10            0 
   13000    4.1451629        16263   0.24166347    42.143972    42.578227    7.5907603         9931           27           27            0         9967        90440        23409        16263   0.93269278            0           10            0 
   14000    5.0478037        16299   0.24222245    42.147894    42.676711     9.616107        10010           39           39            0        10856        90440        23409        16299   0.93132197            0           10            0 
   15000    4.9761523        16318   0.24208522    42.131222    42.652533    10.028283        10181           45           45            0        11744        90440        23409        16318   0.92914494            0           10            0 
   16000    5.0281695        16300   0.24209471    42.127445    42.654206    13.025657        10410           38           38            0        12657        90440        23409        16300    0.9322983            0           10            0 
   17000    6.0553511        16294   0.24278108    42.140765    42.775135    8.3971756         9898           31           31            0        13606        90440        23409        16294   0.93207864            0           10            0 
   18000    5.8870865        16349   0.24261355    42.128876    42.745619    9.4579631         9872           33           33            0        14510        90440        23409        16349   0.92911772            0           10            0 
   19000      6.19767        16260    0.2425369    42.082834    42.732114    10.497489        10068           37           37            0        15478        90440        23409        16260    0.9258668            0           10            0 
   20000    5.0588231        16330   0.24187554    42.085618     42.61559    9.3582625         9935           35           35            0        16470        90440        23409        16330   0.92639501            0           10            0 
   21000    6.4272357        16337   0.24285051     42.11404     42.78737    11.339789         9973           38           38            0        17363        90440        23409        16337   0.91830732            0           10            0 
   22000    6.3660195        16301   0.24257121    42.071243    42.738159    10.340724         9855           41           41            0        18300        90440        23409        16301   0.92735973            0           13            0 
   23000    5.9141967        16265   0.24245321    42.097787     42.71737    10.888473         9874           46           46            0        19294        90440        23409        16265   0.92958577            0           13            0 
   24000    7.3326392        16305   0.24333743    42.104977    42.873159     8.159204         9831           32           32            0        20337        90440        23409        16305   0.92498949            0           13            0 
   25000    7.8712498        16317   0.24365329    42.104202    42.928809      13.3861        10107           51           52            0        21343        90440        23409        16317   0.92093733            0           13            0 
   26000    7.6909446        16302   0.24354679    42.104327    42.910045    9.3626418        10101           45           45            0        22390        90440        23409        16302   0.91881953            0           13            0 
   27000    7.7525711        16296   0.24366541     42.11877    42.930944    9.3545743         9869           31           31            0        23458        90440        23409        16296   0.92276633            0           13            0 
   28000    7.8688635        16287   0.24363999    42.102109    42.926466    9.6143934        10023           37           37            0        24515        90440        23409        16287   0.92561111            0           13            0 
   29000    8.1116441        16298   0.24396496     42.13393    42.983722    9.8457785        10018           37           37            0        25571        90440        23409        16298   0.92896968            0           13            0 
   30000    7.5432306        16233   0.24356273     42.12261    42.912853    10.484741         9978           33           33            0        26714        90440        23409        16233   0.92084331            0           13            0 
   31000    7.9849131        16251   0.24395097    42.144741    42.981256     8.728219         9926           36           36            0        27794        90440        23409        16251   0.91985968            0           13            0 
   32000    8.8200827        16255   0.24461412    42.174088    43.098096    9.4477224        10118           31           31            0        28911        90440        23409        16255   0.92764378            0           13            0 
   33000    9.0462578        16266   0.24476502    42.176979    43.124682    9.0256529         9948           41           41            0        30010        90440        23409        16266   0.92496675            0           13            0 
   34000    11.115911        16273   0.24591951    42.163566     43.32809     10.89006        10013           35           35            1        31155        90440        23409        16273    0.9209011            0           59            0 
   35000    9.5287387        16348   0.24494148    42.157524    43.155772    9.1589486        10058           33           33            0        32262        90440        23409        16348   0.91852697            0           59            0 
   36000    8.6525285        16271   0.24454224    42.178976    43.085431    9.6115865         9936           39           39            0        33447        90440        23409        16271   0.91738637            0           59            0 
   37000    9.3244405        16237   0.24490339    42.172216    43.149062    11.766374        10057           49           49            0        34660        90440        23409        16237   0.92209291            0           59            0 
   38000    9.2952308        16272   0.24496591    42.186292    43.160078    9.5173055        10039           32           32            1        35916        90440        23409        16272   0.91915422            0           59            0 
   39000     10.12307        16312   0.24550971    42.195376    43.255888    10.678168         9989           43           43            1        37116        90440        23409        16312   0.92499805            0           59            0 
   40000    11.051307        16266   0.24606279    42.195578    43.353334    10.078073         9867           37           37            0        38363        90440        23409        16266    0.9229677            0           59            0 
   41000    10.400692        16313   0.24566631    42.193882    43.283479    9.2181368        10040           39           39            0        39612        90440        23409        16313   0.92195363            0           59            0 
   42000    9.0646248        16277   0.24487452    42.194348    43.143975    8.2531891        10173           37           37            0        40821        90440        23409        16277   0.91941681            0           59            0 
   43000    9.8646504        16258   0.24532194    42.189366    43.222806     10.34072        10037           37           37            0        42068        90440        23409        16258   0.91264623            0           59            0 
   44000    10.441846        16296   0.24553053    42.165649    43.259556    12.147264        10299           31           31            0        43277        90440        23409        16296   0.91599514            0           59            0 
   45000    10.458302        16261   0.24544296    42.148496    43.244128    8.8999271        10208           26           26            0        44492        90440        23409        16261   0.91716968            0           59            0 
   46000    10.117248        16269   0.24511999    42.127322    43.187224    9.0053892        10132           36           36            0        45691        90440        23409        16269   0.91327538            0           59            0 
   47000    9.6094606        16247   0.24494761    42.150148    43.156854    11.844069         9936           43           43            0        46930        90440        23409        16247   0.91513796            0           59            0 
   48000    12.544005        16250   0.24661869    42.137144    43.451278    14.420938         9999           43           43            0        48233        90440        23409        16250   0.91642267            0           59            0 
   49000    11.948168        16257   0.24628573    42.140902    43.392614     8.653163        10093           38           38            0        49517        90440        23409        16257   0.90604463            0           59            0 
   50000    12.315254        16233    0.2466687     42.16992    43.460089    9.1125366        10050           39           39            0        50806        90440        23409        16233   0.90490961            0           59            0 
   51000    11.364234        16265   0.24609762    42.168932    43.359471    9.8694192         9860           37           37            0        52074        90440        23409        16265     0.909623            0           59            0 
   52000    10.627787        16231   0.24578998    42.191882    43.305269    10.869196         9877           33           33            0        53420        90440        23409        16231   0.90981484            0           59            0 
   53000    11.809423        16261   0.24656286    42.204263    43.441441     13.38992         9828           39           39            0        54766        90440        23409        16261   0.90710704            0           59            0 
   54000     10.63283        16251   0.24554697    42.148537    43.262453    10.181102        10098           29           29            0        56085        90440        23409        16251   0.90800902            0           59            0 
   55000    10.803075        16254   0.24562954    42.145251    43.277002    7.9856721         9964           26           26            0        57451        90440        23409        16254   0.90786888            0           59            0 
   56000    10.844803        16274    0.2458735    42.183861    43.319983    9.9407901        10031           36           36            0        58695        90440        23409        16274   0.89847818            0           59            0 
   57000    10.623373        16218   0.24574768    42.184891    43.297816    12.015798         9792           43           43            0        60012        90440        23409        16218   0.90944412            0           59            0 
   58000    10.679964        16262   0.24583434    42.194231    43.313084    11.651504         9776           45           45            0        61295        90440        23409        16262   0.90511687            0           59            0 
   59000     10.35931        16278   0.24567475    42.199706    43.284967    10.599471        10069           30           30            1        62506        90440        23409        16278   0.90064789            0           59            0 
   60000    12.034078        16208   0.24677506    42.218115    43.478828    10.511331         9936           31           31            0        63825        90440        23409        16208   0.90250225            0           59            0 
   61000    11.915856        16208   0.24666669    42.211407    43.459734    11.982448        10227           34           34            0        65189        90440        23409        16208   0.90006711            0           59            0 
   62000    11.388719        16269   0.24635856    42.212341    43.405445    8.4867265         9991           29           29            0        66502        90440        23409        16269   0.90418592            0           59            0 
   63000    10.513272        16243   0.24593174    42.228854    43.330244    9.2843187        10133           39           39            0        67836        90440        23409        16243   0.91282932            0           59            0 
   64000    11.465761        16203   0.24638806    42.209467    43.410642    8.8736184        10023           38           39            0        69216        90440        23409        16203   0.90742452            0           59            0 
   65000    9.9798452        16292   0.24547666    42.204557    43.250064    12.475112         9766           36           36            0        70559        90440        23409        16292   0.90921789            0           59            0 
   66000    12.184131        16177    0.2468175    42.209872    43.486305    8.4442171        10049           33           33            0        71851        90440        23409        16177   0.90771921            0           59            0 
   67000    11.845593        16250   0.24645726    42.181869    43.422835    8.2359478         9678           33           33            0        73241        90440        23409        16250    0.9069606            0           59            0 
   68000    10.616202        16220    0.2456631     42.17074    43.282913    7.6844013         9954           28           28            0        74707        90440        23409        16220   0.90830051            0           59            0 
   69000    11.708481        16174     0.246425    42.190549    43.417152    9.6601201        10019           34           34            0        76143        90440        23409        16174   0.90853993            0           59            0 
   70000    13.149115        16175   0.24730865    42.195313     43.57284    7.8721271         9794           31           31            0        77520        90440        23409        16175   0.90460472            0           59            0 
   71000    12.420743        16210   0.24676949    42.176626    43.477846    10.370102         9886           36           36            0        78901        90440        23409        16210   0.90567986            0           59            0 
   72000    13.424842        16222   0.24726211    42.158228     43.56464    10.837461         9892           36           36            0        80221        90440        23409        16222   0.90896224            0           59            0 
   73000    12.983985        16177    0.2470467     42.16646    43.526687    7.3246122         9975           31           31            0        81578        90440        23409        16177   0.90172487            0           59            0 
   74000    11.873207        16217   0.24644792    42.177329    43.421189    11.257297         9937           40           40            0        83004        90440        23409        16217    0.9069376            0           59            0 
   75000    11.719883        16219   0.24631358    42.169723    43.397521    8.2731229        10281           28           28            0        84503        90440        23409        16219   0.90087971            0           59            0 
   76000    11.648725        16220   0.24633978    42.181793    43.402136    11.364684         9961           31           31            0        85910        90440        23409        16220   0.90445518            0           59            0 
   77000    11.315159        16169   0.24618794    42.189986    43.375384    10.639734         9853           35           35            0        87272        90440        23409        16169   0.90967681            0           59            0 
   78000    11.026923        16262    0.2459278     42.17435    43.329551    9.3461335        10068           36           36            0        88765        90440        23409        16262   0.90250223            0           59            0 
   79000    11.923316        16205   0.24657893    42.195162    43.444272    8.3200696         9914           29           29            1        90167        90440        23409        16205   0.89792511            0           59            0 
   80000     12.28723        16233     0.246793    42.194756    43.481989    9.8594414         9898           41           41            0        91543        90440        23409        16233   0.89920018            0           59            0 
   81000    12.657271        16252   0.24700788    42.193847    43.519847    9.5478351        10045           38           38            0        92888        90440        23409        16252   0.90032559            0           59            0 
   82000    10.415047        16249   0.24563975      42.1877      43.2788    8.4502786         9729           30           30            0        94355        90440        23409        16249   0.90516702            0           59            0 
   83000    13.038087        16237   0.24718282    42.184776    43.550671    10.813181         9834           48           48            0        95792        90440        23409        16237   0.90160106            0           59            0 
   84000    11.994728        16253   0.24664911    42.200046    43.456637    10.907779         9632           48           48            0        97203        90440        23409        16253   0.90075335            0           59            0 
   85000    11.560331        16253   0.24626448    42.177788     43.38887    9.8019244         9637           27           27            0        98581        90440        23409        16253   0.90204694            0           59            0 
   86000    12.294346        16214    0.2466302    42.165325    43.453305    8.4731319         9776           30           30            1       100022        90440        23409        16214    0.8976977            0           59            0 
   87000    11.439691        16227   0.24593937    42.133145    43.331589    11.138197         9408           35           35            0       101446        90440        23409        16227   0.90678956            0           59            0 
   88000    12.269451        16218   0.24642733    42.132191    43.417562    9.2022903         9627           28           28            0       102882        90440        23409        16218   0.89354177            0           59            0 
   89000    11.630085        16281   0.24612243    42.145453    43.363843    9.4906584         9713           45           45            0       104390        90440        23409        16281   0.90416008            0           59            0 
   90000    12.068036        16226   0.24636746    42.142743    43.407014     13.55402         9721           30           30            1       105786        90440        23409        16226   0.90693102            0           59            0 
   91000    11.423374        16180   0.24593187    42.133533    43.330267     11.12182         9490           33           33            0       107319        90440        23409        16180   0.89908597            0           59            0 
   92000    11.759782        16253   0.24594059    42.099827    43.331804    8.5785997         9808           36           37            0       108822        90440        23409        16253   0.90323757            0           59            0 
   93000    12.860286        16203   0.24670999    42.120094    43.467362    9.7352723         9342           32           32            0       110320        90440        23409        16203   0.89837993            0           59            0 
   94000     12.65067        16201   0.24650827    42.106515    43.431823    11.726981         9708           37           37            0       111721        90440        23409        16201   0.90153973            0           59            0 
   95000    12.938398        16301    0.2467405    42.117288    43.472739    13.229664         9490           42           42            0       113106        90440        23409        16301   0.89222858            0           59            0 
   96000       13.125        16243   0.24672164    42.094416    43.469416    11.492955         9666           43           43            0       114441        90440        23409        16243   0.89369219            0           59            0 
   97000    14.779601        16270   0.24775001    42.102263    43.650602    9.7132418         9517           31           31            0       115831        90440        23409        16270   0.88854614            0           59            0 
   98000    15.427308        16254   0.24808383    42.093224    43.709418    11.821283         9510           36           37            0       117263        90440        23409        16254   0.88982996            0           59            0 
   99000    16.212104        16248   0.24846852    42.078784    43.777195    10.786344         9807           37           37            0       118659        90440        23409        16248   0.89136464            0           59            0 
  100000       15.896        16229   0.24841013    42.101613    43.766908    10.836017         9640           28           28            0       120081        90440        23409        16229   0.90018614            0           59            0 
Loop time of 53.3125 on 8 procs for 100000 steps with 73999 atoms

Pair  time (%) = 0.559711 (1.04987)
Neigh time (%) = 3.94754 (7.40453)
Comm  time (%) = 3.46588 (6.50106)
Outpt time (%) = 0.00787139 (0.0147646)
Other time (%) = 45.3315 (85.0298)

Nlocal:    9249.88 ave 10477 max 8359 min
Histogram: 1 2 1 1 0 1 0 0 0 2
Nghost:    54 ave 65 max 45 min
Histogram: 2 1 0 0 1 1 0 2 0 1
Neighs:    316.875 ave 387 max 170 min
Histogram: 1 0 0 0 1 0 0 4 0 2

Total # of neighbors = 2535
Ave neighs/atom = 0.0342572
Neighbor list builds = 5000
Dangerous builds = 0

Please see the log.cite file for references relevant to this simulation

