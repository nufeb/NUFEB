LAMMPS (27 Nov 2018)
  using 1 OpenMP thread(s) per MPI task
# 250 butane system for drude polarizability example (Nose-Hoover)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane
  orthogonal box = (-19.1 -19.0999 -19.1) to (19.1 19.1 19.1)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  4500 atoms
  scanning bonds ...
  5 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  9 = max dihedrals/atom
  reading bonds ...
  4250 bonds
  reading angles ...
  6000 angles
  reading dihedrals ...
  6750 dihedrals
  5 = max # of 1-2 neighbors
  8 = max # of 1-3 neighbors
  12 = max # of 1-4 neighbors
  17 = max # of special neighbors

group gBUTANE molecule 1:250
4500 atoms in group gBUTANE
group gCORES type 1 2 3
3500 atoms in group gCORES
group gDRUDES type 4 5
1000 atoms in group gDRUDES

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gCORES  create 260 12345
velocity gDRUDES create ${vTEMP_D} 12345
velocity gDRUDES create 1 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4
  0 = # of size 2 clusters
  500 = # of size 3 clusters
  500 = # of size 4 clusters
  0 = # of frozen angles

comm_modify vel yes
compute cTEMP_CORE gCORES temp/com
compute cTEMP all temp/drude

fix fDIRECT all drude/transform/direct
fix fNVT1 gCORES nvt temp ${vTEMP} ${vTEMP} 100.0
fix fNVT1 gCORES nvt temp 260 ${vTEMP} 100.0
fix fNVT1 gCORES nvt temp 260 260 100.0
fix fNVT2 gDRUDES nvt temp ${vTEMP_D} ${vTEMP_D} 20.0
fix fNVT2 gDRUDES nvt temp 1 ${vTEMP_D} 20.0
fix fNVT2 gDRUDES nvt temp 1 1 20.0
fix fINVERSE all drude/transform/inverse

fix fMOMENTUM all momentum 100 linear 1 1 1

thermo_style custom step cpu etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2]
thermo 50

timestep 0.5
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:321)
  G vector (1/distance) = 0.367867
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.031354
  estimated relative force accuracy = 9.44215e-05
  using double precision FFTs
  3d grid and FFT values/proc = 79507 46656
Rebuild special list taking Drude particles into account
Old max number of 1-2 to 1-4 neighbors: 17
New max number of 1-2 to 1-4 neighbors: 17 (+0)
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 8 8 8
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
  (2) pair thole, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 26.29 | 26.29 | 26.29 Mbytes
Step CPU TotEng KinEng Temp PotEng E_bond E_angle E_dihed E_impro E_vdwl E_coul E_long Press Volume c_cTEMP[1] c_cTEMP[2] 
       0            0    6535.5187      2714.74    248.45112    3820.7787    3724.3278    140.75328    1.4735401            0   -518.77975    595169.42   -594696.41    4439.7916    55742.797    334.61375    18.435655 
      50    1.9199426    2090.3465    1466.1274    134.17896    624.21909    190.60044    660.09649     113.3603            0    -768.0633    595300.82    -594872.6    2826.2298    55742.797    184.22006   0.60185015 
     100    3.8672287    2131.9775    1633.3979    149.48744    498.57958    179.65934    694.88741    164.06284            0   -972.81644    595305.26   -594872.47     1226.789    55742.797     205.4291   0.16019587 
     150    5.7598403    2177.6381    1711.4959    156.63492    466.14214    134.74039    700.59918    168.27759            0   -965.58407    595300.38   -594872.27    4413.0226    55742.797    215.26856   0.12192183 
     200    7.7044377    2233.5218    1730.4556     158.3701    503.06611    188.43014     712.9189    165.88668            0    -988.5136     595295.4   -594871.06    2113.5946    55742.797    217.61368   0.22886584 
     250    9.6830325     2297.301    1773.2292    162.28471    524.07183    151.53589     821.1354    166.81416            0   -1042.1458    595297.16   -594870.43    1173.0574    55742.797      222.691    1.0389647 
     300    11.612487    2368.3956     1891.828    173.13879    476.56753    142.49028    789.96852     154.5939            0   -1037.1885    595297.25   -594870.54    2520.9226    55742.797    236.85673     3.051144 
     350    13.534112    2414.4805    1843.9331    168.75548    570.54737    181.42276    808.67959    163.12794            0   -1005.9572     595293.4   -594870.13    2879.5958    55742.797    231.57282    1.0738202 
     400    15.432559    2466.7093    1924.3089    176.11142    542.40037    167.48008    817.71904    181.25315            0   -1050.6473    595296.37   -594869.77    494.79722    55742.797    241.94266   0.38534823 
     450    17.325742    2522.7871    1875.8855    171.67974    646.90166    133.40905    944.20903    180.31147            0   -1037.0957     595295.5   -594869.43    63.401476    55742.797    235.86638   0.34369113 
     500    19.162983     2580.277    1955.7507    178.98895    624.52624    185.08446    827.39298    175.04156            0   -984.94513    595290.88   -594868.93    3484.9214    55742.797    245.79119   0.67067789 
     550    21.070935    2640.6835    1866.0349    170.77823    774.64852    176.89611    988.92025    176.49761            0   -991.07213    595292.32   -594868.91    1773.3487    55742.797    234.10561    1.7344182 
     600    22.994624    2690.8564    1876.0664     171.6963    814.79004    186.23916    1032.0131     182.3033            0   -1010.7649     595293.3    -594868.3    919.72494    55742.797    235.38014    1.7010295 
     650    24.877667    2732.1824    1963.5421    179.70202    768.64029    165.39218    949.23884    183.81872            0   -951.98446     595290.3   -594868.13    2658.9019    55742.797    246.76774   0.68037803 
     700    26.759878    2775.7295    1921.9362    175.89427     853.7933    175.21242    987.66711    186.48684            0   -918.75412    595291.36   -594868.18    670.06325    55742.797    241.62283   0.44222016 
     750    28.615888    2820.0743    2038.1503    186.53011    781.92393    168.58533    929.80575    193.62705            0   -939.93789    595298.09   -594868.25    398.72744    55742.797    256.20117   0.55407341 
     800    30.410775    2865.9592    1943.5754    177.87467    922.38383    197.16018    1009.2236    201.50387            0   -914.81706    595297.54   -594868.23   -717.10982    55742.797     244.0452    1.2420646 
     850    32.248099    2909.1134    2101.5572    192.33306    807.55624     195.1889    876.12791    184.47417            0   -876.31499    595296.17   -594868.09    -1403.423    55742.797    263.69793    1.8344087 
     900    34.102496    2938.1375    2038.9241    186.60092    899.21338    183.32678     989.0166    184.31256            0   -889.86015    595300.05   -594867.63   -1087.2756    55742.797    256.12731    1.0106116 
     950    35.940632    2965.6943     2007.942    183.76546    957.75234    227.45507    972.71509    206.37948            0   -880.42319    595299.46   -594867.83     -1848.76    55742.797    252.40652   0.53885795 
    1000    37.768527    2994.2318    2058.0187    188.34845     936.2131    170.68954    965.88084    205.36587            0   -833.14442    595294.86   -594867.44    327.63778    55742.797    258.71295   0.52143526 
    1050    39.603905    3022.9502    2095.3849    191.76817    927.56532    203.90713    935.91395      205.082            0   -845.07245    595294.32   -594866.59   -355.70498    55742.797    263.25608   0.94199109 
    1100    41.345196    3051.1765    2047.7198     187.4059    1003.4567    212.39896    989.65688    227.20813            0   -856.11279    595297.04   -594866.74   -1402.0226    55742.797    256.98382     1.677375 
    1150    43.126233    3071.8156    2127.8628    194.74053    943.95283    188.38429    926.24314    223.28057            0   -821.63214    595294.06   -594866.38    550.31162    55742.797    267.19152     1.343134 
    1200    44.919531    3087.7694    2015.2957    184.43847    1072.4737    199.90941    1034.9531    215.15479            0   -804.43316    595293.38   -594866.49   -333.57889    55742.797     253.2678   0.70913779 
    1250    46.708812    3102.5825    2176.9514    199.23308    925.63109    155.81514    956.83605    230.07299            0    -847.4765    595296.65   -594866.26   -932.66378    55742.797    273.66546   0.54750847 
    1300    48.515239    3116.8403    2087.6042    191.05609    1029.2361    209.96221    974.81036    241.13636            0   -823.38395    595292.74   -594866.03   -825.75374    55742.797    262.34482   0.76176534 
    1350    50.311301    3131.0791    2089.6528    191.24358    1041.4264    186.48162    998.11153    233.70979            0   -801.36955    595290.06   -594865.57    684.79541    55742.797    262.36803    1.3871258 
    1400    52.135502     3138.996    2186.2583    200.08485    952.73772    168.60362    957.20176    227.71916            0   -826.52254    595291.08   -594865.34    1796.7314    55742.797    274.47405    1.5135697 
    1450    53.920154    3139.5791    2010.7381    184.02136     1128.841    192.80138    1074.5202    245.37245            0   -807.31625    595288.01   -594864.55   -16.506503    55742.797     252.6314    0.8772328 
    1500    55.713369     3143.899    2099.4529    192.14047    1044.4461    186.04036    980.83507    242.01351            0   -784.81179       595285   -594864.63    2343.8872    55742.797    263.89144    0.6124176 
    1550    57.492258    3149.7317    2086.0668    190.91539    1063.6649    165.80538    1056.0892    230.89557            0   -813.37736    595289.09   -594864.84    2260.7336    55742.797    262.17651   0.69483863 
    1600     59.30172    3156.5347    2013.4253    184.26729    1143.1093    210.65899    1098.2888    243.95147            0   -835.61974    595290.47   -594864.64   -838.56538    55742.797    252.86557    1.1543025 
    1650    61.139585    3160.0034    2081.0689    190.45799    1078.9345     212.2197    1005.7495    250.37949            0   -813.72039    595289.15   -594864.85    796.20008    55742.797    261.22489    1.5557795 
    1700    62.942445    3155.5695    2113.3768    193.41478    1042.1927     146.0358    1019.0909    249.77844            0   -798.16322    595290.59   -594865.14      359.703    55742.797    265.47004    1.0739924 
    1750    64.762126    3151.7963    2063.5473    188.85442     1088.249    224.89092    997.01992    247.37169            0   -807.87664    595291.82   -594864.98   -1081.2896    55742.797    259.34344   0.69485895 
    1800    66.592646    3150.4284    2097.9263    192.00076    1052.5021    202.22769    974.42253    248.58755            0   -799.53819    595291.61    -594864.8     94.59915    55742.797    263.68436   0.65251966 
    1850    68.418504    3153.4497    2106.6304    192.79735    1046.8193    177.57201    971.73173    249.90467            0   -777.13268    595289.76   -594865.02    881.42667    55742.797    264.65056   0.99601086 
    1900    70.216536    3159.2067    2092.2719    191.48328    1066.9348    198.78887    969.41481    260.03017            0   -787.26086    595290.41   -594864.45    606.42691    55742.797     262.6612    1.4839999 
    1950    72.044671    3164.5166    2059.5681    188.49025    1104.9485    214.12266    1000.4479    263.39571            0   -799.45144    595291.13   -594864.69   -1248.7635    55742.797    258.62997    1.2624764 
    2000    73.841754    3171.2996    2080.1586    190.37468    1091.1409    179.21893    996.41501    248.41662            0   -760.00915    595292.04   -594864.94     940.6962    55742.797    261.39988   0.78376244 
Loop time of 73.8418 on 1 procs for 2000 steps with 4500 atoms

Performance: 1.170 ns/day, 20.512 hours/ns, 27.085 timesteps/s
98.7% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.171     | 48.171     | 48.171     |   0.0 | 65.23
Bond    | 3.3962     | 3.3962     | 3.3962     |   0.0 |  4.60
Kspace  | 16.344     | 16.344     | 16.344     |   0.0 | 22.13
Neigh   | 1.6599     | 1.6599     | 1.6599     |   0.0 |  2.25
Comm    | 0.35976    | 0.35976    | 0.35976    |   0.0 |  0.49
Output  | 0.0045705  | 0.0045705  | 0.0045705  |   0.0 |  0.01
Modify  | 3.8475     | 3.8475     | 3.8475     |   0.0 |  5.21
Other   |            | 0.05927    |            |       |  0.08

Nlocal:    4500 ave 4500 max 4500 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    10103 ave 10103 max 10103 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    774433 ave 774433 max 774433 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 774433
Ave neighs/atom = 172.096
Ave special neighs/atom = 13.3333
Neighbor list builds = 35
Dangerous builds = 0
Total wall time: 0:01:14
