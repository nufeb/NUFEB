LAMMPS (27 Nov 2018)
  using 1 OpenMP thread(s) per MPI task
# 250 butane system for drude polarizability example (Nose-Hoover)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane
  orthogonal box = (-19.1 -19.0999 -19.1) to (19.1 19.1 19.1)
  2 by 1 by 2 MPI processor grid
  reading atoms ...
  4500 atoms
  scanning bonds ...
  5 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  9 = max dihedrals/atom
  reading bonds ...
  4250 bonds
  reading angles ...
  6000 angles
  reading dihedrals ...
  6750 dihedrals
  5 = max # of 1-2 neighbors
  8 = max # of 1-3 neighbors
  12 = max # of 1-4 neighbors
  17 = max # of special neighbors

group gBUTANE molecule 1:250
4500 atoms in group gBUTANE
group gCORES type 1 2 3
3500 atoms in group gCORES
group gDRUDES type 4 5
1000 atoms in group gDRUDES

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gCORES  create 260 12345
velocity gDRUDES create ${vTEMP_D} 12345
velocity gDRUDES create 1 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4
  0 = # of size 2 clusters
  500 = # of size 3 clusters
  500 = # of size 4 clusters
  0 = # of frozen angles

comm_modify vel yes
compute cTEMP_CORE gCORES temp/com
compute cTEMP all temp/drude

fix fDIRECT all drude/transform/direct
fix fNVT1 gCORES nvt temp ${vTEMP} ${vTEMP} 100.0
fix fNVT1 gCORES nvt temp 260 ${vTEMP} 100.0
fix fNVT1 gCORES nvt temp 260 260 100.0
fix fNVT2 gDRUDES nvt temp ${vTEMP_D} ${vTEMP_D} 20.0
fix fNVT2 gDRUDES nvt temp 1 ${vTEMP_D} 20.0
fix fNVT2 gDRUDES nvt temp 1 1 20.0
fix fINVERSE all drude/transform/inverse

fix fMOMENTUM all momentum 100 linear 1 1 1

thermo_style custom step cpu etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2]
thermo 50

timestep 0.5
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:321)
  G vector (1/distance) = 0.367867
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.031354
  estimated relative force accuracy = 9.44215e-05
  using double precision FFTs
  3d grid and FFT values/proc = 26875 11664
Rebuild special list taking Drude particles into account
Old max number of 1-2 to 1-4 neighbors: 17
New max number of 1-2 to 1-4 neighbors: 17 (+0)
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 8 8 8
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
  (2) pair thole, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 16.75 | 17.03 | 17.13 Mbytes
Step CPU TotEng KinEng Temp PotEng E_bond E_angle E_dihed E_impro E_vdwl E_coul E_long Press Volume c_cTEMP[1] c_cTEMP[2] 
       0            0    6535.5187      2714.74    248.45112    3820.7787    3724.3278    140.75328    1.4735401            0   -518.77975    595169.42   -594696.41    4439.7916    55742.797    334.61375    18.435655 
      50   0.63524747    2090.3465    1466.1274    134.17896     624.2191    190.60044    660.09649     113.3603            0    -768.0633    595300.82    -594872.6    2826.2298    55742.797    184.22006   0.60185015 
     100    1.2804167    2131.9774    1633.3979    149.48744    498.57955    179.65934    694.88741    164.06284            0   -972.81644    595305.26   -594872.47     1226.789    55742.797     205.4291   0.16019587 
     150    1.9264774    2177.6381    1711.4959    156.63492    466.14218    134.74039    700.59917    168.27759            0   -965.58407    595300.38   -594872.27    4413.0227    55742.797    215.26856   0.12192187 
     200    2.5798194    2233.5217    1730.4557     158.3701    503.06601    188.43014     712.9189    165.88668            0    -988.5136     595295.4   -594871.06    2113.5944    55742.797    217.61368   0.22886584 
     250     3.234822    2297.3011    1773.2292    162.28471    524.07191     151.5359     821.1354    166.81416            0   -1042.1458    595297.16   -594870.43    1173.0577    55742.797      222.691    1.0389643 
     300    3.9885037    2368.3956     1891.828    173.13879    476.56759    142.49027    789.96852     154.5939            0   -1037.1885    595297.25   -594870.54    2520.9227    55742.797    236.85673    3.0511439 
     350    4.7276039    2414.4804    1843.9331    168.75548    570.54727    181.42277     808.6796    163.12794            0   -1005.9572     595293.4   -594870.13    2879.5954    55742.797    231.57282    1.0738212 
     400    5.3416793    2466.7094    1924.3089    176.11142    542.40044    167.48008    817.71904    181.25315            0   -1050.6473    595296.37   -594869.77    494.79737    55742.797    241.94266   0.38534799 
     450    6.0018888    2522.7872    1875.8855    171.67974    646.90169    133.40906    944.20903    180.31147            0   -1037.0957     595295.5   -594869.43     63.40141    55742.797    235.86638   0.34369111 
     500    6.6298664    2580.2771    1955.7507    178.98895    624.52635    185.08445    827.39297    175.04156            0   -984.94513    595290.88   -594868.93    3484.9216    55742.797    245.79119   0.67067791 
     550    7.2369561    2640.6835     1866.035    170.77823    774.64858    176.89609    988.92025    176.49761            0   -991.07212    595292.32   -594868.91    1773.3486    55742.797    234.10561    1.7344207 
     600    7.8453741    2690.8569    1876.0664     171.6963     814.7905    186.23916    1032.0131     182.3033            0   -1010.7649     595293.3    -594868.3    919.72487    55742.797    235.38014    1.7010285 
     650    8.4387105    2732.1825    1963.5421    179.70202    768.64035    165.39219    949.23884    183.81872            0   -951.98446     595290.3   -594868.13    2658.9017    55742.797    246.76774   0.68037827 
     700    9.0765064    2775.7294    1921.9362    175.89427    853.79318    175.21242    987.66712    186.48684            0   -918.75413    595291.36   -594868.18    670.06264    55742.797    241.62283   0.44222019 
     750    9.6925657    2820.0741    2038.1504    186.53011    781.92376    168.58531    929.80574    193.62706            0    -939.9379    595298.09   -594868.25    398.72752    55742.797    256.20117   0.55407442 
     800    10.302839     2865.959    1943.5754    177.87467    922.38359    197.16019    1009.2236    201.50386            0   -914.81706    595297.54   -594868.23   -717.10975    55742.797     244.0452    1.2420644 
     850    10.916842    2909.1138    2101.5572    192.33306    807.55656    195.18897    876.12792    184.47417            0   -876.31499    595296.17   -594868.09   -1403.4232    55742.797    263.69793    1.8344028 
     900    11.513051    2938.1376    2038.9242    186.60093    899.21343    183.32681    989.01659    184.31258            0   -889.86018    595300.05   -594867.63   -1087.2761    55742.797    256.12732    1.0106144 
     950     12.11419    2965.6942     2007.942    183.76546    957.75216    227.45503    972.71506    206.37949            0    -880.4232    595299.46   -594867.83   -1848.7603    55742.797    252.40653   0.53885876 
    1000    12.740639    2994.2317    2058.0187    188.34845    936.21302    170.68957    965.88085    205.36589            0   -833.14441    595294.86   -594867.44     327.6391    55742.797    258.71295   0.52143283 
    1050    13.346812    3022.9501    2095.3848    191.76817    927.56526    203.90712    935.91396    205.08197            0   -845.07232    595294.32   -594866.59   -355.70418    55742.797    263.25608   0.94198602 
    1100    13.938097    3051.1769    2047.7199     187.4059     1003.457    212.39892    989.65684    227.20812            0   -856.11277    595297.04   -594866.74    -1402.022    55742.797    256.98383    1.6773742 
    1150    14.508841    3071.8157    2127.8626    194.74051    943.95311    188.38445    926.24309    223.28071            0   -821.63207    595294.06   -594866.38    550.31236    55742.797     267.1915    1.3431353 
    1200    15.110682    3087.7694    2015.2955    184.43845    1072.4739    199.90932    1034.9531    215.15511            0   -804.43314    595293.38   -594866.49   -333.57793    55742.797    253.26777   0.70913778 
    1250    15.728746    3102.5825    2176.9518    199.23312    925.63076    155.81519    956.83624     230.0728            0   -847.47674    595296.65   -594866.26   -932.66685    55742.797    273.66551   0.54750805 
    1300    16.365541    3116.8403    2087.6045    191.05612    1029.2357    209.96201    974.81053    241.13608            0   -823.38398    595292.74   -594866.03   -825.75383    55742.797    262.34486   0.76175709 
    1350    16.943579    3131.0787    2089.6524    191.24354    1041.4264    186.48189    998.11168    233.71019            0   -801.37003    595290.06   -594865.57    684.79151    55742.797    262.36797    1.3871293 
    1400    17.542898     3138.996    2186.2582    200.08483    952.73785    168.60338    957.20178    227.71944            0   -826.52269    595291.08   -594865.34    1796.7295    55742.797    274.47403    1.5135537 
    1450    18.144658    3139.5791    2010.7377    184.02132    1128.8414     192.8015    1074.5205    245.37206            0    -807.3159    595288.01   -594864.55   -16.504608    55742.797    252.63135   0.87723467 
    1500    18.759382    3143.8991    2099.4529    192.14048    1044.4462    186.04014    980.83524    242.01309            0   -784.81131       595285   -594864.63    2343.8986    55742.797    263.89145   0.61241549 
    1550    19.331644    3149.7316     2086.068     190.9155    1063.6635    165.80546    1056.0893    230.89463            0   -813.37768    595289.09   -594864.84    2260.7364    55742.797    262.17666   0.69483626 
    1600     19.91757     3156.535    2013.4276     184.2675    1143.1073    210.65881    1098.2892    243.94955            0   -835.62037    595290.47   -594864.64   -838.57356    55742.797    252.86585    1.1542996 
    1650    20.503137    3160.0031    2081.0656    190.45768    1078.9375     212.2197    1005.7509    250.38023            0   -813.71955    595289.15   -594864.85    796.21731    55742.797    261.22447    1.5557945 
    1700    21.130273    3155.5677    2113.3761    193.41472    1042.1916      146.036    1019.0909    249.77802            0   -798.16357    595290.59   -594865.14    359.69262    55742.797    265.46995     1.074008 
    1750    21.735444     3151.796    2063.5487    188.85455    1088.2472    224.89093    997.02075    247.36817            0   -807.87592    595291.82   -594864.98   -1081.2667    55742.797    259.34362   0.69484916 
    1800    22.302735    3150.4232    2097.9294    192.00105    1052.4938    202.22751    974.42358    248.58229            0   -799.53722     595291.6    -594864.8     94.58692    55742.797    263.68474   0.65252808 
    1850    22.902581    3153.4477    2106.6272    192.79706    1046.8205    177.57166    971.73469    249.90348            0   -777.13298    595289.76   -594865.02    881.42516    55742.797    264.65016   0.99601444 
    1900    23.480426    3159.2037    2092.2693    191.48304    1066.9343    198.78895    969.41309    260.03288            0   -787.26163    595290.41   -594864.45    606.40366    55742.797    262.66088    1.4839893 
    1950    24.086136    3164.5139    2059.5653    188.48999    1104.9485    214.12027    1000.4493    263.39543            0   -799.45067    595291.13   -594864.69   -1248.7209    55742.797    258.62963    1.2624825 
    2000    24.655188    3171.2963    2080.1555    190.37439    1091.1408    179.21892    996.41486    248.41626            0   -760.00877    595292.04   -594864.94    940.70366    55742.797    261.39948    0.7837686 
Loop time of 24.6553 on 4 procs for 2000 steps with 4500 atoms

Performance: 3.504 ns/day, 6.849 hours/ns, 81.119 timesteps/s
96.3% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.825     | 12.439     | 13.012     |  12.2 | 50.45
Bond    | 0.82239    | 0.89713    | 0.95859    |   5.7 |  3.64
Kspace  | 6.6353     | 7.2001     | 7.8139     |  15.7 | 29.20
Neigh   | 0.44976    | 0.44994    | 0.45003    |   0.0 |  1.82
Comm    | 0.55452    | 0.62432    | 0.70013    |   6.6 |  2.53
Output  | 0.003664   | 0.0043042  | 0.0061252  |   1.6 |  0.02
Modify  | 2.9457     | 2.959      | 2.9736     |   0.7 | 12.00
Other   |            | 0.08099    |            |       |  0.33

Nlocal:    1125 ave 1166 max 1096 min
Histogram: 2 0 0 0 0 0 1 0 0 1
Nghost:    5867.25 ave 5956 max 5793 min
Histogram: 1 1 0 0 0 0 1 0 0 1
Neighs:    193608 ave 200510 max 186198 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 774433
Ave neighs/atom = 172.096
Ave special neighs/atom = 13.3333
Neighbor list builds = 35
Dangerous builds = 0
Total wall time: 0:00:24
