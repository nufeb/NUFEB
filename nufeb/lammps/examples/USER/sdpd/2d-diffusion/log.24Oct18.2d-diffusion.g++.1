LAMMPS (24 Oct 2018)
dimension       2
units           micro
atom_style      meso

variable        R equal 0.5             # radius of sphere          micrometers
variable        a equal $R/5            # lattice spacing           micrometers
variable        a equal 0.5/5            
variable        L equal $R*3
variable        L equal 0.5*3
variable        T equal 300.
variable        rho_0 equal 1.          # density                   picograms/micrometer^3
variable        c_0 equal 100.          # speed of sound            micrometers/microsecond
variable        mu equal 1.             # dynamic viscosity         picogram/(micrometer-microsecond)
variable        h equal $a*4.5          # kernel function cutoff    micrometers
variable        h equal 0.1*4.5          
variable        mass equal $a*$a*$a*${rho_0}
variable        mass equal 0.1*$a*$a*${rho_0}
variable        mass equal 0.1*0.1*$a*${rho_0}
variable        mass equal 0.1*0.1*0.1*${rho_0}
variable        mass equal 0.1*0.1*0.1*1
variable        dt equal 1e-3           # timestep                  microseconds
variable        skin equal 0.2*$h
variable        skin equal 0.2*0.45

region          box block -$L $L -$L $L 0 $a units box
region          box block -1.5 $L -$L $L 0 $a units box
region          box block -1.5 1.5 -$L $L 0 $a units box
region          box block -1.5 1.5 -1.5 $L 0 $a units box
region          box block -1.5 1.5 -1.5 1.5 0 $a units box
region          box block -1.5 1.5 -1.5 1.5 0 0.1 units box
create_box      2 box
Created orthogonal box = (-1.5 -1.5 0) to (1.5 1.5 0.1)
  1 by 1 by 1 MPI processor grid
lattice         sq $a
lattice         sq 0.1
Lattice spacing in x,y,z = 0.1 0.1 0.1

create_atoms    1 box
Created 900 atoms
  Time spent = 0.0015769 secs

region          sphere sphere 0 0 0 $R units box
region          sphere sphere 0 0 0 0.5 units box
set             region sphere type 2
  81 settings made for type

group           fluid type 1
819 atoms in group fluid
group           sphere type 2
81 atoms in group sphere

mass            * ${mass}
mass            * 0.001
set             group all meso/rho ${rho_0}
set             group all meso/rho 1
  900 settings made for meso/rho

pair_style      sdpd/taitwater/isothermal $T ${mu} 76787    # temperature viscosity random_seed
pair_style      sdpd/taitwater/isothermal 300 ${mu} 76787    
pair_style      sdpd/taitwater/isothermal 300 1 76787    
pair_coeff      * * ${rho_0} ${c_0} ${h}
pair_coeff      * * 1 ${c_0} ${h}
pair_coeff      * * 1 100 ${h}
pair_coeff      * * 1 100 0.45

fix             1 fluid meso
fix             2 sphere rigid/meso single
1 rigid bodies with 81 atoms

fix             2d all enforce2d

neighbor        ${skin} bin
neighbor        0.09 bin
neigh_modify	delay 0 every 1 check yes
timestep        ${dt}
timestep        0.001

dump            dump_id all atom 100 dump.lammpstrj

thermo          100
thermo_style    custom step time nbuild ndanger

run             10000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 0.54
  ghost atom cutoff = 0.54
  binsize = 0.27, bins = 12 12 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sdpd/taitwater/isothermal, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 6.137 | 6.137 | 6.137 Mbytes
Step Time Nbuild Ndanger 
       0            0        0        0 
     100          0.1        0        0 
     200          0.2        0        0 
     300          0.3        0        0 
     400          0.4        1        0 
     500          0.5        1        0 
     600          0.6        1        0 
     700          0.7        2        0 
     800          0.8        2        0 
     900          0.9        2        0 
    1000            1        3        0 
    1100          1.1        3        0 
    1200          1.2        3        0 
    1300          1.3        4        0 
    1400          1.4        4        0 
    1500          1.5        4        0 
    1600          1.6        5        0 
    1700          1.7        5        0 
    1800          1.8        6        0 
    1900          1.9        6        0 
    2000            2        6        0 
    2100          2.1        7        0 
    2200          2.2        7        0 
    2300          2.3        7        0 
    2400          2.4        7        0 
    2500          2.5        8        0 
    2600          2.6        8        0 
    2700          2.7        8        0 
    2800          2.8        9        0 
    2900          2.9        9        0 
    3000            3       10        0 
    3100          3.1       10        0 
    3200          3.2       10        0 
    3300          3.3       11        0 
    3400          3.4       11        0 
    3500          3.5       11        0 
    3600          3.6       12        0 
    3700          3.7       12        0 
    3800          3.8       12        0 
    3900          3.9       13        0 
    4000            4       13        0 
    4100          4.1       13        0 
    4200          4.2       14        0 
    4300          4.3       14        0 
    4400          4.4       14        0 
    4500          4.5       15        0 
    4600          4.6       15        0 
    4700          4.7       15        0 
    4800          4.8       16        0 
    4900          4.9       16        0 
    5000            5       17        0 
    5100          5.1       17        0 
    5200          5.2       17        0 
    5300          5.3       17        0 
    5400          5.4       18        0 
    5500          5.5       18        0 
    5600          5.6       18        0 
    5700          5.7       19        0 
    5800          5.8       19        0 
    5900          5.9       19        0 
    6000            6       19        0 
    6100          6.1       20        0 
    6200          6.2       20        0 
    6300          6.3       20        0 
    6400          6.4       21        0 
    6500          6.5       21        0 
    6600          6.6       21        0 
    6700          6.7       21        0 
    6800          6.8       22        0 
    6900          6.9       22        0 
    7000            7       22        0 
    7100          7.1       23        0 
    7200          7.2       23        0 
    7300          7.3       23        0 
    7400          7.4       24        0 
    7500          7.5       24        0 
    7600          7.6       24        0 
    7700          7.7       25        0 
    7800          7.8       25        0 
    7900          7.9       26        0 
    8000            8       26        0 
    8100          8.1       26        0 
    8200          8.2       26        0 
    8300          8.3       27        0 
    8400          8.4       27        0 
    8500          8.5       27        0 
    8600          8.6       28        0 
    8700          8.7       28        0 
    8800          8.8       28        0 
    8900          8.9       29        0 
    9000            9       29        0 
    9100          9.1       29        0 
    9200          9.2       30        0 
    9300          9.3       30        0 
    9400          9.4       30        0 
    9500          9.5       30        0 
    9600          9.6       31        0 
    9700          9.7       31        0 
    9800          9.8       32        0 
    9900          9.9       32        0 
   10000           10       32        0 
Loop time of 80.9456 on 1 procs for 10000 steps with 900 atoms

Performance: 10673829.855 ns/day, 0.000 hours/ns, 123.540 timesteps/s
99.8% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 80.306     | 80.306     | 80.306     |   0.0 | 99.21
Neigh   | 0.017418   | 0.017418   | 0.017418   |   0.0 |  0.02
Comm    | 0.16939    | 0.16939    | 0.16939    |   0.0 |  0.21
Output  | 0.070281   | 0.070281   | 0.070281   |   0.0 |  0.09
Modify  | 0.3154     | 0.3154     | 0.3154     |   0.0 |  0.39
Other   |            | 0.067      |            |       |  0.08

Nlocal:    900 ave 900 max 900 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    762 ave 762 max 762 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    40697 ave 40697 max 40697 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40697
Ave neighs/atom = 45.2189
Neighbor list builds = 32
Dangerous builds = 0
Total wall time: 0:01:20
